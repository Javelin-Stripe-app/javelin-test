"use strict";var __StripeExtExports=(()=>{var wt=Object.create;var ne=Object.defineProperty,_t=Object.defineProperties,It=Object.getOwnPropertyDescriptor,Pt=Object.getOwnPropertyDescriptors,Ct=Object.getOwnPropertyNames,Ne=Object.getOwnPropertySymbols,Tt=Object.getPrototypeOf,Ke=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable;var Ue=(n,t,r)=>t in n?ne(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,B=(n,t)=>{for(var r in t||(t={}))Ke.call(t,r)&&Ue(n,r,t[r]);if(Ne)for(var r of Ne(t))At.call(t,r)&&Ue(n,r,t[r]);return n},re=(n,t)=>_t(n,Pt(t));var l=(n=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(n,{get:(t,r)=>(typeof require!="undefined"?require:t)[r]}):n)(function(n){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+n+'" is not supported')});var S=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),kt=(n,t)=>{for(var r in t)ne(n,r,{get:t[r],enumerable:!0})},be=(n,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ct(t))!Ke.call(n,o)&&o!==r&&ne(n,o,{get:()=>t[o],enumerable:!(s=It(t,o))||s.enumerable});return n},D=(n,t,r)=>(be(n,t,"default"),r&&be(r,t,"default")),T=(n,t,r)=>(r=n!=null?wt(Tt(n)):{},be(t||!n||!n.__esModule?ne(r,"default",{value:n,enumerable:!0}):r,n)),xt=n=>be(ne({},"__esModule",{value:!0}),n);var c=(n,t,r)=>new Promise((s,o)=>{var d=p=>{try{u(r.next(p))}catch(v){o(v)}},a=p=>{try{u(r.throw(p))}catch(v){o(v)}},u=p=>p.done?s(p.value):Promise.resolve(p.value).then(d,a);u((r=r.apply(n,t)).next())});var ke=S(ve=>{"use strict";Object.defineProperty(ve,"__esModule",{value:!0});ve.SDK_VERSION=void 0;ve.SDK_VERSION="9.1.0"});var A=S(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.TableHeaderCell=e.TableHead=e.TableFooter=e.TableCell=e.TableBody=e.Tab=e.TabPanels=e.TabPanel=e.TabList=e.Switch=e.StripeFileUploader=e.Spinner=e.Sparkline=e.SignInView=e.SettingsView=e.Select=e.Radio=e.PropertyList=e.PropertyListItem=e.PlatformConfigurationView=e.OnboardingView=e.Menu=e.MenuItem=e.MenuGroup=e.List=e.ListItem=e.Link=e.LineChart=e.Inline=e.Img=e.Icon=e.FormFieldGroup=e.FocusView=e.Divider=e.DetailPageTable=e.DetailPagePropertyList=e.DetailPageModule=e.DateField=e.ContextView=e.Chip=e.ChipList=e.Checkbox=e.Button=e.ButtonGroup=e.Box=e.BarChart=e.Banner=e.Badge=e.Accordion=e.AccordionItem=void 0;e.Tooltip=e.TextField=e.TextArea=e.TaskList=e.TaskListItem=e.Tabs=e.TableRow=e.Table=void 0;var Bt=l("react/jsx-runtime"),Et=l("@remote-ui/react"),Mt=ke(),Ft=n=>{let t=n.displayName||n.toString(),r=s=>(0,Bt.jsx)(n,re(B({},s),{wrappedComponentName:t,sdkVersion:Mt.SDK_VERSION,schemaVersion:"v9"}));return r.wrappedComponentName=t,r},i=(n,t,r)=>{let s=(0,Et.createRemoteReactComponent)(n,{fragmentProps:t});return r?Ft(s):s};e.AccordionItem=i("AccordionItem",["title","actions","media","subtitle"],!0);e.Accordion=i("Accordion",[],!0);e.Badge=i("Badge",[],!0);e.Banner=i("Banner",["actions","description","title"],!0);e.BarChart=i("BarChart",[],!0);e.Box=i("Box",[],!0);e.ButtonGroup=i("ButtonGroup",["menuTrigger"],!0);e.Button=i("Button",[],!0);e.Checkbox=i("Checkbox",["label"],!0);e.ChipList=i("ChipList",[],!0);e.Chip=i("Chip",[],!0);e.ContextView=i("ContextView",["actions","banner","footerContent","primaryAction","secondaryAction"],!0);e.DateField=i("DateField",["label"],!0);e.DetailPageModule=i("DetailPageModule",[],!0);e.DetailPagePropertyList=i("DetailPagePropertyList",[],!0);e.DetailPageTable=i("DetailPageTable",[],!0);e.Divider=i("Divider",[],!0);e.FocusView=i("FocusView",["footerContent","primaryAction","secondaryAction"],!0);e.FormFieldGroup=i("FormFieldGroup",[],!0);e.Icon=i("Icon",[],!0);e.Img=i("Img",[],!0);e.Inline=i("Inline",[],!0);e.LineChart=i("LineChart",[],!0);e.Link=i("Link",[],!0);e.ListItem=i("ListItem",["icon","image","secondaryTitle","title","value"],!0);e.List=i("List",[],!0);e.MenuGroup=i("MenuGroup",["title"],!0);e.MenuItem=i("MenuItem",[],!0);e.Menu=i("Menu",["trigger"],!0);e.OnboardingView=i("OnboardingView",["error"],!0);e.PlatformConfigurationView=i("PlatformConfigurationView",[],!0);e.PropertyListItem=i("PropertyListItem",["label","value"],!0);e.PropertyList=i("PropertyList",[],!0);e.Radio=i("Radio",["label"],!0);e.Select=i("Select",["label"],!0);e.SettingsView=i("SettingsView",[],!0);e.SignInView=i("SignInView",["descriptionActionContents","footerContent"],!0);e.Sparkline=i("Sparkline",[],!0);e.Spinner=i("Spinner",[],!0);e.StripeFileUploader=i("StripeFileUploader",[],!0);e.Switch=i("Switch",["label"],!0);e.TabList=i("TabList",[],!0);e.TabPanel=i("TabPanel",[],!0);e.TabPanels=i("TabPanels",[],!0);e.Tab=i("Tab",[],!0);e.TableBody=i("TableBody",[],!0);e.TableCell=i("TableCell",[],!0);e.TableFooter=i("TableFooter",[],!0);e.TableHead=i("TableHead",[],!0);e.TableHeaderCell=i("TableHeaderCell",[],!0);e.Table=i("Table",[],!0);e.TableRow=i("TableRow",[],!0);e.Tabs=i("Tabs",[],!0);e.TaskListItem=i("TaskListItem",[],!0);e.TaskList=i("TaskList",[],!0);e.TextArea=i("TextArea",["label"],!0);e.TextField=i("TextField",["label"],!0);e.Tooltip=i("Tooltip",["trigger"],!0)});var xe=S((Vn,je)=>{"use strict";var Rt=function(n,t,r,s,o,d,a,u){if(!n){var p;if(t===void 0)p=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var v=[r,s,o,d,a,u],M=0;p=new Error(t.replace(/%s/g,function(){return v[M++]})),p.name="Invariant Violation"}throw p.framesToPop=1,p}};je.exports=Rt});var se=S($=>{"use strict";var Lt=$&&$.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty($,"__esModule",{value:!0});$.getHostEndpoint=void 0;var Ot=Lt(xe()),Dt=()=>{var t;let n=(t=globalThis.__StripeExtExports)==null?void 0:t.endpoint;return(0,Ot.default)(n,"hostEndpoint has not been initialized"),n};$.getHostEndpoint=Dt});var Be=S(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.supportsFetchAppEmbeddedKey=void 0;var Ht=se(),qt=()=>c(ie,null,function*(){return(0,Ht.getHostEndpoint)().call.supportsFetchAppEmbeddedKey().then(n=>n).catch(()=>!1)});ie.supportsFetchAppEmbeddedKey=qt});var We=S(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.fetchAppEmbeddedKey=void 0;var Nt=se(),Ut=()=>c(oe,null,function*(){let n=yield(0,Nt.getHostEndpoint)().call.fetchAppEmbeddedKey();if(!n)throw new Error("Unable to fetch app embedded key");return n});oe.fetchAppEmbeddedKey=Ut});var Je=S(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.fetchViaFrame=void 0;var Kt=We(),zt=(r,...s)=>c(ae,[r,...s],function*(n,t={}){let o=yield(0,Kt.fetchAppEmbeddedKey)(),d=re(B({},t),{headers:re(B({},t.headers),{Authorization:`Bearer ${o}`})}),a=yield fetch(n,d),u={};a.headers.forEach((v,M)=>{u[M]=v});let p={json:void 0,arrayBuffer:void 0,headers:u,ok:a.ok,redirected:a.redirected,status:a.status,statusText:a.statusText,type:a.type,url:a.url};switch(a.headers.get("Content-Type")){case"application/json":p.json=yield a.json();break;default:p.arrayBuffer=yield a.arrayBuffer();break}return p});ae.fetchViaFrame=zt});var Ge=S(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.fetchViaHost=void 0;var jt=se(),Wt=(r,...s)=>c(ce,[r,...s],function*(n,t={}){let o=new URL(n);return(0,jt.getHostEndpoint)().call.stripeApiFetch(o.pathname+o.search,t)});ce.fetchViaHost=Wt});var $e=S(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.selectPreferredStripeApiFetch=void 0;var Jt=Be(),Gt=Je(),$t=Ge(),Ee=null,Yt=()=>c(le,null,function*(){return Ee||(Ee=(yield(0,Jt.supportsFetchAppEmbeddedKey)())?Gt.fetchViaFrame:$t.fetchViaHost),Ee});le.selectPreferredStripeApiFetch=Yt});var Ye=S(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.selectPreferredStripeApiFetch=void 0;var Zt=$e();Object.defineProperty(Se,"selectPreferredStripeApiFetch",{enumerable:!0,get:function(){return Zt.selectPreferredStripeApiFetch}})});var Ze=S(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.stripeApiFetch=void 0;var Xt=Ye(),Qt=(n,t)=>c(de,null,function*(){return(yield(0,Xt.selectPreferredStripeApiFetch)())(n,t)});de.stripeApiFetch=Qt});var Xe=S(_=>{"use strict";var en=_&&_.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(_,"__esModule",{value:!0});_.AUTHORIZATION_VALUE=_.AUTHORIZATION_HEADER=_.createHttpClient=_.STRIPE_API_KEY=_.StripeAppsHttpClient=void 0;var tn=en(xe()),nn=Ze(),rn=/[ps]k_(test|live)_[A-Za-z0-9]+/,Me=class{constructor(t){this._resp=t}getHeaders(){return this._resp.headers}getStatusCode(){return this._resp.status}getRawResponse(){return this._resp}toStream(){throw new Error("Streams have not been implemented in the Stripe HTTP client")}toJSON(){let{json:t}=this._resp;return t===void 0?Promise.reject(new Error("Response body undefined")):Promise.resolve(t)}},we=class{constructor(t){this._fetch=t}getClientName(){return"stripe-ui-extension"}makeRequest(t,r,s,o,d,a,u,p){return c(this,null,function*(){(0,tn.default)(u==="https","Must use https connections in UI extensions");let v={method:o,headers:d};a&&(v.body=a);let M=d.Authorization;if(M&&rn.test(M))throw new Error("Do not use actual stripe keys when using the Stripe JS API client with UI extesions.\n\n Instead, use `STRIPE_API_KEY` from `@stripe/ui-extension-sdk/http_client` as a placeholder.");let ge=new URL(s,`${u}://${t}`),Ce=yield this._fetch(ge.toString(),v);return new Me(Ce)})}};_.StripeAppsHttpClient=we;_.STRIPE_API_KEY="DO_NOT_PASS_A_REAL_API_KEY";var sn=()=>new we(nn.stripeApiFetch);_.createHttpClient=sn;_.AUTHORIZATION_HEADER="Authorization";_.AUTHORIZATION_VALUE=`Bearer ${_.STRIPE_API_KEY}`});var Qe=S(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.createFetchStripeSignatureDirectly=void 0;var on=Xe(),an=({host:n,port:t})=>r=>c(pe,null,function*(){let s=new URL(`https://${n}:${t}/v1/apps/app_embedded_backend_signature`);return s.searchParams.set("payload",JSON.stringify(B({},r))),s.searchParams.set("include_only[]","signature"),(0,on.createHttpClient)().makeRequest(n,t,s.pathname+s.search,"GET",{},null,"https").then(a=>a.toJSON()).then(a=>a.signature)});pe.createFetchStripeSignatureDirectly=an});var tt=S(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.setConnectionSettings=K.connectionSettings=void 0;var et={host:"api.stripe.com",port:443};K.connectionSettings=et;var cn=n=>{K.connectionSettings=B(B({},et),n)};K.setConnectionSettings=cn});var nt=S(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.fetchStripeSignature=void 0;var ln=Qe(),dn=Be(),pn=tt(),un=se(),gn=n=>c(ue,null,function*(){return(yield(0,dn.supportsFetchAppEmbeddedKey)())?(0,ln.createFetchStripeSignatureDirectly)(pn.connectionSettings)(n):(0,un.getHostEndpoint)().call.fetchStripeSignature(n)});ue.fetchStripeSignature=gn});var rt=S(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});var mn=nt();Fe.default=mn.fetchStripeSignature});var R={};kt(R,{BUILD_TIME:()=>An,ChatView:()=>gt,OnboardingView:()=>ht,SettingsView:()=>mt,default:()=>kn});var b=T(A()),g=l("react");var Re=T(A());var H=T(A()),U=l("react/jsx-runtime"),Vt=({role:n,content:t,freshness:r})=>{let s=n==="user";return(0,U.jsxs)(H.Box,{css:{padding:"medium",backgroundColor:s?"container":void 0,stack:"y",gap:"small"},children:[(0,U.jsx)(H.Inline,{css:{fontWeight:"semibold",color:"secondary"},children:s?"You":"Javelin"}),(0,U.jsx)(H.Inline,{children:t}),r&&!s&&(0,U.jsx)(H.Box,{css:{marginTop:"xsmall"},children:(0,U.jsx)(H.Badge,{type:r.type==="live"?"positive":"info",children:r.type==="live"?"Live data":`Data as of ${r.syncedAt?new Date(r.syncedAt).toLocaleString():"cache"}`})})]})},ze=Vt;var k=T(A()),Ve=l("react");var it=T(rt());var st,hn=typeof process!="undefined"&&((st=process.env)==null?void 0:st.SUPABASE_FUNCTIONS_URL)?process.env.SUPABASE_FUNCTIONS_URL:"https://tecvycpmzcxxoqmtttjy.supabase.co/functions/v1";function E(r){return c(this,arguments,function*(n,t={}){let s=yield(0,it.default)(),o=yield fetch(`${hn}${n}`,{method:t.method||"GET",headers:{"Content-Type":"application/json","stripe-signature":s},body:t.body?JSON.stringify(t.body):void 0});if(!o.ok)throw yield o.json();return o.json()})}var F=l("react/jsx-runtime"),fn=({insightId:n,messageId:t,content:r})=>{let[s,o]=(0,Ve.useState)(null),[d,a]=(0,Ve.useState)(!1),u=p=>c(void 0,null,function*(){if(!(d||s)){a(!0);try{yield E("/insights-feedback",{method:"POST",body:{insightId:n,messageId:t,rating:p}}),o(p)}catch(v){}finally{a(!1)}}});return(0,F.jsxs)(k.Box,{css:{padding:"small",stack:"y",gap:"small"},children:[(0,F.jsx)(k.Banner,{type:"default",title:"Insight",description:r}),(0,F.jsxs)(k.Box,{css:{stack:"x",gap:"small"},children:[(0,F.jsx)(k.Button,{type:s==="positive"?"primary":"secondary",size:"small",disabled:d||s!==null,onPress:()=>u("positive"),children:(0,F.jsx)(k.Inline,{children:s==="positive"?"Helpful":"Helpful?"})}),(0,F.jsx)(k.Button,{type:s==="negative"?"primary":"secondary",size:"small",disabled:d||s!==null,onPress:()=>u("negative"),children:(0,F.jsx)(k.Inline,{children:s==="negative"?"Not helpful":"Not helpful?"})})]})]})},ot=fn;var V=T(A()),_e=l("react"),z=l("react/jsx-runtime"),yn=({startedAt:n})=>{let[t,r]=(0,_e.useState)(0);(0,_e.useEffect)(()=>{let o=setInterval(()=>{r(Math.floor((Date.now()-n)/1e3))},1e3);return()=>clearInterval(o)},[n]);let s=t>=5?"Fetching fresh data from Stripe...":"Analyzing your data...";return(0,z.jsxs)(V.Box,{css:{padding:"medium",stack:"y",gap:"small"},children:[(0,z.jsxs)(V.Box,{css:{stack:"x",gap:"small",alignY:"center"},children:[(0,z.jsx)(V.Spinner,{size:"small"}),(0,z.jsx)(V.Inline,{css:{color:"secondary"},children:s})]}),t>=5&&(0,z.jsx)(V.Banner,{type:"default",description:"Still working \u2014 fetching the latest data from Stripe to give you an accurate answer."})]})},at=yn;var j=T(A()),Y=l("react/jsx-runtime"),bn=({question:n,options:t,onSelect:r})=>(0,Y.jsxs)(j.Box,{css:{padding:"medium",stack:"y",gap:"small"},children:[(0,Y.jsx)(j.Banner,{type:"default",title:"Clarification needed",description:n}),(0,Y.jsx)(j.Box,{css:{stack:"x",gap:"small",wrap:"wrap"},children:t.map(s=>(0,Y.jsx)(j.Button,{type:"secondary",size:"small",onPress:()=>r(s.value),children:s.label},s.value))})]}),ct=bn;var q=l("react/jsx-runtime"),vn=({messages:n,isThinking:t,thinkingStartedAt:r,onClarificationSelect:s})=>(0,q.jsxs)(Re.Box,{css:{stack:"y",gap:"xsmall",overflow:"auto"},children:[n.map(o=>{var d;return(0,q.jsxs)(Re.Box,{css:{stack:"y"},children:[(0,q.jsx)(ze,{role:o.role,content:o.content,freshness:o.freshness}),(d=o.insights)==null?void 0:d.map(a=>(0,q.jsx)(ot,{insightId:a.id,messageId:o.id,content:a.content},a.id)),o.clarification&&s&&(0,q.jsx)(ct,{question:o.clarification.question,options:o.clarification.options,onSelect:s})]},o.id)}),t&&r&&(0,q.jsx)(at,{startedAt:r})]}),lt=vn;var W=T(A()),Ie=l("react"),Z=l("react/jsx-runtime"),Sn=({onSend:n,disabled:t=!1,initialValue:r=""})=>{let[s,o]=(0,Ie.useState)(r),d=(0,Ie.useCallback)(()=>{let a=s.trim();!a||t||(n(a),o(""))},[s,t,n]);return(0,Z.jsxs)(W.Box,{css:{stack:"x",gap:"small",alignY:"bottom",padding:"small"},children:[(0,Z.jsx)(W.Box,{css:{width:"fill"},children:(0,Z.jsx)(W.TextArea,{label:"Ask a question",placeholder:"What's my MRR?",value:s,onChange:a=>o(a.target.value),rows:2,disabled:t})}),(0,Z.jsx)(W.Button,{type:"primary",onPress:d,disabled:t||!s.trim(),children:"Send"})]})},dt=Sn;var f=T(A()),w=l("react/jsx-runtime"),wn=[{label:"What's my MRR?",value:"What's my MRR?"},{label:"How's churn trending?",value:"How is my churn rate trending over the last 3 months?"},{label:"Revenue by product",value:"What's my revenue breakdown by product?"},{label:"Top customers",value:"Who are my top 10 customers by revenue?"},{label:"Growth rate",value:"What's my MRR growth rate?"}],_n=({onSelectPrompt:n,insights:t})=>(0,w.jsxs)(f.Box,{css:{padding:"medium",stack:"y",gap:"medium"},children:[(0,w.jsxs)(f.Box,{css:{stack:"y",gap:"small"},children:[(0,w.jsx)(f.Inline,{css:{font:"heading"},children:"Welcome to Javelin"}),(0,w.jsx)(f.Inline,{css:{color:"secondary"},children:"Ask me anything about your Stripe business. I can calculate metrics, analyze trends, and surface insights from your data."})]}),t&&t.length>0&&(0,w.jsxs)(f.Box,{css:{stack:"y",gap:"small"},children:[(0,w.jsx)(f.Inline,{css:{fontWeight:"semibold"},children:"Recent insights"}),t.map(r=>(0,w.jsx)(f.Box,{css:{padding:"small",backgroundColor:"container",stack:"y",gap:"xsmall"},children:(0,w.jsx)(f.Inline,{css:{color:"secondary"},children:r.content})},r.id))]}),(0,w.jsxs)(f.Box,{css:{stack:"y",gap:"small"},children:[(0,w.jsx)(f.Inline,{css:{fontWeight:"semibold"},children:"Try asking"}),(0,w.jsx)(f.Box,{css:{stack:"x",gap:"small",wrap:"wrap"},children:wn.map(r=>(0,w.jsx)(f.Button,{type:"secondary",size:"small",onPress:()=>n(r.value),children:r.label},r.value))})]}),(0,w.jsx)(f.Box,{css:{marginTop:"small"},children:(0,w.jsx)(f.Inline,{css:{font:"caption",color:"secondary"},children:"Javelin provides informational insights only, not financial or business advice. Always verify important decisions with your own analysis."})})]}),pt=_n;var I=T(A()),C=l("react/jsx-runtime"),In=({conversations:n,activeConversationId:t,onSelectConversation:r,onClose:s})=>n.length===0?(0,C.jsxs)(I.Box,{css:{padding:"medium",stack:"y",gap:"small",alignX:"center"},children:[(0,C.jsx)(I.Inline,{css:{color:"secondary"},children:"No conversations yet."}),(0,C.jsx)(I.Inline,{css:{color:"secondary"},children:"Start by asking a question below."})]}):(0,C.jsxs)(I.Box,{css:{stack:"y",gap:"xsmall",padding:"small"},children:[(0,C.jsxs)(I.Box,{css:{stack:"x",distribute:"space-between",alignY:"center",padding:"xsmall"},children:[(0,C.jsx)(I.Inline,{css:{fontWeight:"semibold"},children:"Conversations"}),(0,C.jsx)(I.Button,{type:"secondary",size:"small",onPress:s,children:"Close"})]}),n.map(o=>(0,C.jsx)(I.Box,{css:{padding:"small",backgroundColor:o.id===t?"container":void 0,stack:"y",gap:"xsmall"},children:(0,C.jsx)(I.Button,{type:"secondary",size:"small",onPress:()=>r(o.id),children:(0,C.jsxs)(I.Box,{css:{stack:"y",gap:"xsmall",width:"fill"},children:[(0,C.jsx)(I.Inline,{css:{fontWeight:o.id===t?"semibold":"regular"},children:o.title||"Untitled conversation"}),(0,C.jsx)(I.Inline,{css:{font:"caption",color:"secondary"},children:new Date(o.updatedAt).toLocaleDateString()})]})})},o.id))]}),ut=In;var y=l("react/jsx-runtime"),Pn=({userContext:n,environment:t})=>{let[r,s]=(0,g.useState)("loading"),[o,d]=(0,g.useState)([]),[a,u]=(0,g.useState)(null),[p,v]=(0,g.useState)([]),[M,ge]=(0,g.useState)(!1),[Ce,Le]=(0,g.useState)(),[Oe,G]=(0,g.useState)(null),[ft,yt]=(0,g.useState)([]),[Te,me]=(0,g.useState)(!1),De=(0,g.useCallback)(()=>c(void 0,null,function*(){var h;try{let N=((h=(yield E("/chat-conversations")).data)==null?void 0:h.conversations)||[];d(N),N.length===0?(Ae(),s("empty")):(yield He(N[0].id),s("chat"))}catch(L){s("empty"),Ae()}}),[]);(0,g.useEffect)(()=>{De()},[De]);let Ae=()=>c(void 0,null,function*(){var h;try{let L=yield E("/insights-welcome");yt(((h=L.data)==null?void 0:h.insights)||[])}catch(L){}}),He=h=>c(void 0,null,function*(){var L;try{let fe=(((L=(yield E(`/chat-conversation-detail?conversationId=${h}`)).data)==null?void 0:L.messages)||[]).map(O=>{var Q,ee;return{id:O.id,role:O.role,content:O.content,freshness:(Q=O.metadata)==null?void 0:Q.freshness,insights:(ee=O.metadata)==null?void 0:ee.insights}});v(fe),u(h)}catch(N){G("Failed to load conversation")}}),he=(0,g.useCallback)(h=>c(void 0,null,function*(){var fe,O,Q,ee,qe;G(null);let N={id:`temp-${Date.now()}`,role:"user",content:h};v(x=>[...x,N]),s("chat"),ge(!0),Le(Date.now());try{let x=yield E("/chat-message",{method:"POST",body:{conversationId:a,content:h}}),te={id:((fe=x.data)==null?void 0:fe.message.id)||`msg-${Date.now()}`,role:"assistant",content:((O=x.data)==null?void 0:O.message.content)||"Sorry, I could not generate a response.",freshness:x.meta,insights:(Q=x.data)==null?void 0:Q.insights};((ee=x.data)==null?void 0:ee.conversationId)&&!a&&u(x.data.conversationId),v(ye=>[...ye,te])}catch(x){let te=x,ye=(qe=te==null?void 0:te.error)==null?void 0:qe.code;G(ye==="auth_refresh_failed"?"Your session has expired. Please re-authorize Javelin.":ye==="llm_unavailable"?"AI service is temporarily unavailable. Please try again in a moment.":"Something went wrong. Please try again.")}finally{ge(!1),Le(void 0)}}),[a]),bt=(0,g.useCallback)(h=>{he(h)},[he]),vt=(0,g.useCallback)(()=>{u(null),v([]),s("empty"),me(!1),Ae()},[]),St=(0,g.useCallback)(h=>c(void 0,null,function*(){me(!1),yield He(h),s("chat")}),[]);return r==="loading"?(0,y.jsx)(b.ContextView,{title:"Javelin",children:(0,y.jsxs)(b.Box,{css:{padding:"medium",stack:"y",gap:"medium",alignX:"center"},children:[(0,y.jsx)(b.Spinner,{}),(0,y.jsx)(b.Inline,{css:{color:"secondary"},children:"Loading Javelin..."})]})}):(0,y.jsx)(b.ContextView,{title:"Javelin",actions:(0,y.jsxs)(b.Box,{css:{stack:"x",gap:"small"},children:[o.length>0&&(0,y.jsx)(b.Button,{type:"secondary",onPress:()=>me(h=>!h),children:"History"}),(0,y.jsx)(b.Button,{type:"secondary",onPress:vt,children:"New chat"})]}),children:(0,y.jsxs)(b.Box,{css:{stack:"y",height:"fill"},children:[Oe&&(0,y.jsx)(b.Banner,{type:"critical",title:"Error",description:Oe,onDismiss:()=>G(null)}),Te&&(0,y.jsx)(ut,{conversations:o,activeConversationId:a,onSelectConversation:St,onClose:()=>me(!1)}),!Te&&(0,y.jsx)(b.Box,{css:{stack:"y",overflow:"auto"},children:r==="empty"&&p.length===0?(0,y.jsx)(pt,{onSelectPrompt:he,insights:ft}):(0,y.jsx)(lt,{messages:p,isThinking:M,thinkingStartedAt:Ce,onClarificationSelect:bt})}),!Te&&(0,y.jsx)(dt,{onSend:he,disabled:M})]})})},gt=Pn;var X=T(A()),Pe=l("react/jsx-runtime"),Cn=({userContext:n})=>(0,Pe.jsx)(X.SettingsView,{children:(0,Pe.jsx)(X.Box,{css:{padding:"medium"},children:(0,Pe.jsx)(X.Inline,{children:"Javelin settings coming soon."})})}),mt=Cn;var P=T(A()),J=l("react");var m=l("react/jsx-runtime"),Tn=({userContext:n,oauthContext:t})=>{let[r,s]=(0,J.useState)("processing"),[o,d]=(0,J.useState)(""),a=(0,J.useCallback)(()=>c(void 0,null,function*(){if(t!=null&&t.error){s("error"),d(`Authorization failed: ${t.error}`);return}if(!(t!=null&&t.code)){s("error"),d("No authorization code received. Please try installing again.");return}try{yield E("/auth-callback",{method:"POST",body:{code:t.code,state:t.state||"",verifier:t.verifier||""}}),yield E("/sync-trigger",{method:"POST",body:{}}),s("success")}catch(u){s("error"),d("Failed to complete setup. Please try again.")}}),[t]);return(0,J.useEffect)(()=>{a()},[a]),(0,m.jsx)(P.ContextView,{title:"Welcome to Javelin",children:(0,m.jsxs)(P.Box,{css:{padding:"medium",stack:"y",gap:"medium",alignX:"center"},children:[r==="processing"&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(P.Spinner,{}),(0,m.jsx)(P.Inline,{children:"Setting up Javelin..."}),(0,m.jsx)(P.Inline,{css:{color:"secondary"},children:"Connecting to your Stripe account and syncing your data."})]}),r==="success"&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(P.Banner,{type:"default",title:"Setup complete!",description:"Javelin is ready. Your data is syncing in the background \u2014 you can start asking questions right away."}),(0,m.jsx)(P.Inline,{css:{color:"secondary"},children:"Open the Javelin drawer from any page in your Stripe Dashboard to get started."})]}),r==="error"&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(P.Banner,{type:"critical",title:"Setup failed",description:o}),(0,m.jsx)(P.Button,{type:"primary",onPress:a,children:"Retry"})]})]})})},ht=Tn;D(R,T(ke()));var An="2026-02-12 15:33:03.509477 -0300 -03 m=+3.007036314";var kn={allowed_redirect_uris:["https://dashboard.stripe.com/test/apps-oauth/com.javelin.ai","https://dashboard.stripe.com/apps-oauth/com.javelin.ai"],connect_permissions:null,distribution_type:"public",icon:"./icon.png",id:"com.javelin.ai",name:"Javelin",permissions:[{permission:"customer_read",purpose:"Read customer data to calculate business metrics and answer questions about your customer base"},{permission:"invoice_read",purpose:"Read invoice data to calculate revenue, MRR, and other billing metrics"},{permission:"charge_read",purpose:"Read charge data to analyze payment volume and revenue trends"},{permission:"subscription_read",purpose:"Read subscription data to calculate MRR, churn rate, and subscription analytics"},{permission:"product_read",purpose:"Read product data to break down revenue and metrics by product"},{permission:"plan_read",purpose:"Read price and plan data to analyze plan-level revenue and subscriber counts"},{permission:"secret_write",purpose:"Store and manage OAuth tokens securely via the Secret Store API"}],sandbox_install_compatible:!0,stripe_api_access_type:"oauth",ui_extension:{content_security_policy:{"connect-src":["https://tecvycpmzcxxoqmtttjy.supabase.co/functions/v1/","https://openrouter.ai/api/","https://api.openai.com/v1/"],"image-src":null,purpose:"Connect to Supabase backend for data processing and LLM provider for AI-powered business intelligence"},views:[{component:"ChatView",viewport:"stripe.dashboard.drawer.default"},{component:"SettingsView",viewport:"settings"},{component:"OnboardingView",viewport:"onboarding"}]},version:"0.0.1"};return xt(R);})();
//# sourceMappingURL=ext.min.js.map
