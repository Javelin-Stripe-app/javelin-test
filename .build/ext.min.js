"use strict";var __StripeExtExports=(()=>{var Pt=Object.create;var ne=Object.defineProperty,At=Object.defineProperties,Tt=Object.getOwnPropertyDescriptor,kt=Object.getOwnPropertyDescriptors,Ct=Object.getOwnPropertyNames,ze=Object.getOwnPropertySymbols,Bt=Object.getPrototypeOf,We=Object.prototype.hasOwnProperty,xt=Object.prototype.propertyIsEnumerable;var je=(e,n,i)=>n in e?ne(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,T=(e,n)=>{for(var i in n||(n={}))We.call(n,i)&&je(e,i,n[i]);if(ze)for(var i of ze(n))xt.call(n,i)&&je(e,i,n[i]);return e},ie=(e,n)=>At(e,kt(n));var l=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(n,i)=>(typeof require!="undefined"?require:n)[i]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var S=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),Et=(e,n)=>{for(var i in n)ne(e,i,{get:n[i],enumerable:!0})},be=(e,n,i,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of Ct(n))!We.call(e,a)&&a!==i&&ne(e,a,{get:()=>n[a],enumerable:!(r=Tt(n,a))||r.enumerable});return e},D=(e,n,i)=>(be(e,n,"default"),i&&be(i,n,"default")),k=(e,n,i)=>(i=e!=null?Pt(Bt(e)):{},be(n||!e||!e.__esModule?ne(i,"default",{value:e,enumerable:!0}):i,e)),Mt=e=>be(ne({},"__esModule",{value:!0}),e);var c=(e,n,i)=>new Promise((r,a)=>{var d=p=>{try{u(i.next(p))}catch(v){a(v)}},o=p=>{try{u(i.throw(p))}catch(v){a(v)}},u=p=>p.done?r(p.value):Promise.resolve(p.value).then(d,o);u((i=i.apply(e,n)).next())});var xe=S(ve=>{"use strict";Object.defineProperty(ve,"__esModule",{value:!0});ve.SDK_VERSION=void 0;ve.SDK_VERSION="9.1.0"});var C=S(t=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TableHeaderCell=t.TableHead=t.TableFooter=t.TableCell=t.TableBody=t.Tab=t.TabPanels=t.TabPanel=t.TabList=t.Switch=t.StripeFileUploader=t.Spinner=t.Sparkline=t.SignInView=t.SettingsView=t.Select=t.Radio=t.PropertyList=t.PropertyListItem=t.PlatformConfigurationView=t.OnboardingView=t.Menu=t.MenuItem=t.MenuGroup=t.List=t.ListItem=t.Link=t.LineChart=t.Inline=t.Img=t.Icon=t.FormFieldGroup=t.FocusView=t.Divider=t.DetailPageTable=t.DetailPagePropertyList=t.DetailPageModule=t.DateField=t.ContextView=t.Chip=t.ChipList=t.Checkbox=t.Button=t.ButtonGroup=t.Box=t.BarChart=t.Banner=t.Badge=t.Accordion=t.AccordionItem=void 0;t.Tooltip=t.TextField=t.TextArea=t.TaskList=t.TaskListItem=t.Tabs=t.TableRow=t.Table=void 0;var Ft=l("react/jsx-runtime"),Vt=l("@remote-ui/react"),Rt=xe(),Ot=e=>{let n=e.displayName||e.toString(),i=r=>(0,Ft.jsx)(e,ie(T({},r),{wrappedComponentName:n,sdkVersion:Rt.SDK_VERSION,schemaVersion:"v9"}));return i.wrappedComponentName=n,i},s=(e,n,i)=>{let r=(0,Vt.createRemoteReactComponent)(e,{fragmentProps:n});return i?Ot(r):r};t.AccordionItem=s("AccordionItem",["title","actions","media","subtitle"],!0);t.Accordion=s("Accordion",[],!0);t.Badge=s("Badge",[],!0);t.Banner=s("Banner",["actions","description","title"],!0);t.BarChart=s("BarChart",[],!0);t.Box=s("Box",[],!0);t.ButtonGroup=s("ButtonGroup",["menuTrigger"],!0);t.Button=s("Button",[],!0);t.Checkbox=s("Checkbox",["label"],!0);t.ChipList=s("ChipList",[],!0);t.Chip=s("Chip",[],!0);t.ContextView=s("ContextView",["actions","banner","footerContent","primaryAction","secondaryAction"],!0);t.DateField=s("DateField",["label"],!0);t.DetailPageModule=s("DetailPageModule",[],!0);t.DetailPagePropertyList=s("DetailPagePropertyList",[],!0);t.DetailPageTable=s("DetailPageTable",[],!0);t.Divider=s("Divider",[],!0);t.FocusView=s("FocusView",["footerContent","primaryAction","secondaryAction"],!0);t.FormFieldGroup=s("FormFieldGroup",[],!0);t.Icon=s("Icon",[],!0);t.Img=s("Img",[],!0);t.Inline=s("Inline",[],!0);t.LineChart=s("LineChart",[],!0);t.Link=s("Link",[],!0);t.ListItem=s("ListItem",["icon","image","secondaryTitle","title","value"],!0);t.List=s("List",[],!0);t.MenuGroup=s("MenuGroup",["title"],!0);t.MenuItem=s("MenuItem",[],!0);t.Menu=s("Menu",["trigger"],!0);t.OnboardingView=s("OnboardingView",["error"],!0);t.PlatformConfigurationView=s("PlatformConfigurationView",[],!0);t.PropertyListItem=s("PropertyListItem",["label","value"],!0);t.PropertyList=s("PropertyList",[],!0);t.Radio=s("Radio",["label"],!0);t.Select=s("Select",["label"],!0);t.SettingsView=s("SettingsView",[],!0);t.SignInView=s("SignInView",["descriptionActionContents","footerContent"],!0);t.Sparkline=s("Sparkline",[],!0);t.Spinner=s("Spinner",[],!0);t.StripeFileUploader=s("StripeFileUploader",[],!0);t.Switch=s("Switch",["label"],!0);t.TabList=s("TabList",[],!0);t.TabPanel=s("TabPanel",[],!0);t.TabPanels=s("TabPanels",[],!0);t.Tab=s("Tab",[],!0);t.TableBody=s("TableBody",[],!0);t.TableCell=s("TableCell",[],!0);t.TableFooter=s("TableFooter",[],!0);t.TableHead=s("TableHead",[],!0);t.TableHeaderCell=s("TableHeaderCell",[],!0);t.Table=s("Table",[],!0);t.TableRow=s("TableRow",[],!0);t.Tabs=s("Tabs",[],!0);t.TaskListItem=s("TaskListItem",[],!0);t.TaskList=s("TaskList",[],!0);t.TextArea=s("TextArea",["label"],!0);t.TextField=s("TextField",["label"],!0);t.Tooltip=s("Tooltip",["trigger"],!0)});var Ee=S((Ln,$e)=>{"use strict";var Dt=function(e,n,i,r,a,d,o,u){if(!e){var p;if(n===void 0)p=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var v=[i,r,a,d,o,u],M=0;p=new Error(n.replace(/%s/g,function(){return v[M++]})),p.name="Invariant Violation"}throw p.framesToPop=1,p}};$e.exports=Dt});var re=S(G=>{"use strict";var qt=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(G,"__esModule",{value:!0});G.getHostEndpoint=void 0;var Ht=qt(Ee()),Nt=()=>{var n;let e=(n=globalThis.__StripeExtExports)==null?void 0:n.endpoint;return(0,Ht.default)(e,"hostEndpoint has not been initialized"),e};G.getHostEndpoint=Nt});var Me=S(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.supportsFetchAppEmbeddedKey=void 0;var Ut=re(),Kt=()=>c(se,null,function*(){return(0,Ut.getHostEndpoint)().call.supportsFetchAppEmbeddedKey().then(e=>e).catch(()=>!1)});se.supportsFetchAppEmbeddedKey=Kt});var Ge=S(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.fetchAppEmbeddedKey=void 0;var zt=re(),jt=()=>c(ae,null,function*(){let e=yield(0,zt.getHostEndpoint)().call.fetchAppEmbeddedKey();if(!e)throw new Error("Unable to fetch app embedded key");return e});ae.fetchAppEmbeddedKey=jt});var Ye=S(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.fetchViaFrame=void 0;var Wt=Ge(),Jt=(i,...r)=>c(oe,[i,...r],function*(e,n={}){let a=yield(0,Wt.fetchAppEmbeddedKey)(),d=ie(T({},n),{headers:ie(T({},n.headers),{Authorization:`Bearer ${a}`})}),o=yield fetch(e,d),u={};o.headers.forEach((v,M)=>{u[M]=v});let p={json:void 0,arrayBuffer:void 0,headers:u,ok:o.ok,redirected:o.redirected,status:o.status,statusText:o.statusText,type:o.type,url:o.url};switch(o.headers.get("Content-Type")){case"application/json":p.json=yield o.json();break;default:p.arrayBuffer=yield o.arrayBuffer();break}return p});oe.fetchViaFrame=Jt});var Ze=S(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.fetchViaHost=void 0;var $t=re(),Gt=(i,...r)=>c(ce,[i,...r],function*(e,n={}){let a=new URL(e);return(0,$t.getHostEndpoint)().call.stripeApiFetch(a.pathname+a.search,n)});ce.fetchViaHost=Gt});var Xe=S(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.selectPreferredStripeApiFetch=void 0;var Yt=Me(),Zt=Ye(),Xt=Ze(),Fe=null,Qt=()=>c(le,null,function*(){return Fe||(Fe=(yield(0,Yt.supportsFetchAppEmbeddedKey)())?Zt.fetchViaFrame:Xt.fetchViaHost),Fe});le.selectPreferredStripeApiFetch=Qt});var Qe=S(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.selectPreferredStripeApiFetch=void 0;var en=Xe();Object.defineProperty(Se,"selectPreferredStripeApiFetch",{enumerable:!0,get:function(){return en.selectPreferredStripeApiFetch}})});var et=S(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.stripeApiFetch=void 0;var tn=Qe(),nn=(e,n)=>c(de,null,function*(){return(yield(0,tn.selectPreferredStripeApiFetch)())(e,n)});de.stripeApiFetch=nn});var tt=S(_=>{"use strict";var rn=_&&_.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_,"__esModule",{value:!0});_.AUTHORIZATION_VALUE=_.AUTHORIZATION_HEADER=_.createHttpClient=_.STRIPE_API_KEY=_.StripeAppsHttpClient=void 0;var sn=rn(Ee()),an=et(),on=/[ps]k_(test|live)_[A-Za-z0-9]+/,Ve=class{constructor(n){this._resp=n}getHeaders(){return this._resp.headers}getStatusCode(){return this._resp.status}getRawResponse(){return this._resp}toStream(){throw new Error("Streams have not been implemented in the Stripe HTTP client")}toJSON(){let{json:n}=this._resp;return n===void 0?Promise.reject(new Error("Response body undefined")):Promise.resolve(n)}},we=class{constructor(n){this._fetch=n}getClientName(){return"stripe-ui-extension"}makeRequest(n,i,r,a,d,o,u,p){return c(this,null,function*(){(0,sn.default)(u==="https","Must use https connections in UI extensions");let v={method:a,headers:d};o&&(v.body=o);let M=d.Authorization;if(M&&on.test(M))throw new Error("Do not use actual stripe keys when using the Stripe JS API client with UI extesions.\n\n Instead, use `STRIPE_API_KEY` from `@stripe/ui-extension-sdk/http_client` as a placeholder.");let ge=new URL(r,`${u}://${n}`),ke=yield this._fetch(ge.toString(),v);return new Ve(ke)})}};_.StripeAppsHttpClient=we;_.STRIPE_API_KEY="DO_NOT_PASS_A_REAL_API_KEY";var cn=()=>new we(an.stripeApiFetch);_.createHttpClient=cn;_.AUTHORIZATION_HEADER="Authorization";_.AUTHORIZATION_VALUE=`Bearer ${_.STRIPE_API_KEY}`});var nt=S(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.createFetchStripeSignatureDirectly=void 0;var ln=tt(),dn=({host:e,port:n})=>i=>c(pe,null,function*(){let r=new URL(`https://${e}:${n}/v1/apps/app_embedded_backend_signature`);return r.searchParams.set("payload",JSON.stringify(T({},i))),r.searchParams.set("include_only[]","signature"),(0,ln.createHttpClient)().makeRequest(e,n,r.pathname+r.search,"GET",{},null,"https").then(o=>o.toJSON()).then(o=>o.signature)});pe.createFetchStripeSignatureDirectly=dn});var rt=S(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.setConnectionSettings=K.connectionSettings=void 0;var it={host:"api.stripe.com",port:443};K.connectionSettings=it;var pn=e=>{K.connectionSettings=T(T({},it),e)};K.setConnectionSettings=pn});var st=S(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.fetchStripeSignature=void 0;var un=nt(),gn=Me(),mn=rt(),hn=re(),fn=e=>c(ue,null,function*(){return(yield(0,gn.supportsFetchAppEmbeddedKey)())?(0,un.createFetchStripeSignatureDirectly)(mn.connectionSettings)(e):(0,hn.getHostEndpoint)().call.fetchStripeSignature(e)});ue.fetchStripeSignature=fn});var at=S(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});var yn=st();Re.default=yn.fetchStripeSignature});var R={};Et(R,{BUILD_TIME:()=>xn,ChatView:()=>ft,OnboardingView:()=>bt,SettingsView:()=>yt,default:()=>En});var b=k(C()),g=l("react");var Le=k(C());var q=k(C()),U=l("react/jsx-runtime"),Lt=({role:e,content:n,freshness:i})=>{let r=e==="user";return(0,U.jsxs)(q.Box,{css:{padding:"medium",backgroundColor:r?"container":void 0,stack:"y",gap:"small"},children:[(0,U.jsx)(q.Inline,{css:{fontWeight:"semibold",color:"secondary"},children:r?"You":"Javelin"}),(0,U.jsx)(q.Inline,{children:n}),i&&!r&&(0,U.jsx)(q.Box,{css:{marginTop:"xsmall"},children:(0,U.jsx)(q.Badge,{type:i.type==="live"?"positive":"info",children:i.type==="live"?"Live data":`Data as of ${i.syncedAt?new Date(i.syncedAt).toLocaleString():"cache"}`})})]})},Je=Lt;var B=k(C()),Oe=l("react");var ct=k(at());var ot,bn=typeof process!="undefined"&&((ot=process.env)==null?void 0:ot.SUPABASE_FUNCTIONS_URL)?process.env.SUPABASE_FUNCTIONS_URL:"https://tecvycpmzcxxoqmtttjy.supabase.co/functions/v1",_e=null;function Ie(e,n){_e={userId:e,accountId:n}}function E(i){return c(this,arguments,function*(e,n={}){if(!_e)throw new Error("apiClient not initialized \u2014 call initApiClient first");let r="";try{r=yield(0,ct.default)()}catch(u){console.warn("fetchStripeSignature failed \u2014 sending unsigned request")}let a=n.method||"POST",d=T({user_id:_e.userId,account_id:_e.accountId},n.body&&typeof n.body=="object"?n.body:{}),o=yield fetch(`${bn}${e}`,{method:a,headers:T({"Content-Type":"application/json"},r?{"stripe-signature":r}:{}),body:JSON.stringify(d)});if(!o.ok)throw yield o.json();return o.json()})}var F=l("react/jsx-runtime"),vn=({insightId:e,messageId:n,content:i})=>{let[r,a]=(0,Oe.useState)(null),[d,o]=(0,Oe.useState)(!1),u=p=>c(void 0,null,function*(){if(!(d||r)){o(!0);try{yield E("/insights-feedback",{method:"POST",body:{insightId:e,messageId:n,rating:p}}),a(p)}catch(v){}finally{o(!1)}}});return(0,F.jsxs)(B.Box,{css:{padding:"small",stack:"y",gap:"small"},children:[(0,F.jsx)(B.Banner,{type:"default",title:"Insight",description:i}),(0,F.jsxs)(B.Box,{css:{stack:"x",gap:"small"},children:[(0,F.jsx)(B.Button,{type:r==="positive"?"primary":"secondary",size:"small",disabled:d||r!==null,onPress:()=>u("positive"),children:(0,F.jsx)(B.Inline,{children:r==="positive"?"Helpful":"Helpful?"})}),(0,F.jsx)(B.Button,{type:r==="negative"?"primary":"secondary",size:"small",disabled:d||r!==null,onPress:()=>u("negative"),children:(0,F.jsx)(B.Inline,{children:r==="negative"?"Not helpful":"Not helpful?"})})]})]})},lt=vn;var V=k(C()),Pe=l("react"),z=l("react/jsx-runtime"),Sn=({startedAt:e})=>{let[n,i]=(0,Pe.useState)(0);(0,Pe.useEffect)(()=>{let a=setInterval(()=>{i(Math.floor((Date.now()-e)/1e3))},1e3);return()=>clearInterval(a)},[e]);let r=n>=5?"Fetching fresh data from Stripe...":"Analyzing your data...";return(0,z.jsxs)(V.Box,{css:{padding:"medium",stack:"y",gap:"small"},children:[(0,z.jsxs)(V.Box,{css:{stack:"x",gap:"small",alignY:"center"},children:[(0,z.jsx)(V.Spinner,{size:"small"}),(0,z.jsx)(V.Inline,{css:{color:"secondary"},children:r})]}),n>=5&&(0,z.jsx)(V.Banner,{type:"default",description:"Still working \u2014 fetching the latest data from Stripe to give you an accurate answer."})]})},dt=Sn;var j=k(C()),Y=l("react/jsx-runtime"),wn=({question:e,options:n,onSelect:i})=>(0,Y.jsxs)(j.Box,{css:{padding:"medium",stack:"y",gap:"small"},children:[(0,Y.jsx)(j.Banner,{type:"default",title:"Clarification needed",description:e}),(0,Y.jsx)(j.Box,{css:{stack:"x",gap:"small",wrap:"wrap"},children:n.map(r=>(0,Y.jsx)(j.Button,{type:"secondary",size:"small",onPress:()=>i(r.value),children:r.label},r.value))})]}),pt=wn;var H=l("react/jsx-runtime"),_n=({messages:e,isThinking:n,thinkingStartedAt:i,onClarificationSelect:r})=>(0,H.jsxs)(Le.Box,{css:{stack:"y",gap:"xsmall",overflow:"auto"},children:[e.map(a=>{var d;return(0,H.jsxs)(Le.Box,{css:{stack:"y"},children:[(0,H.jsx)(Je,{role:a.role,content:a.content,freshness:a.freshness}),(d=a.insights)==null?void 0:d.map(o=>(0,H.jsx)(lt,{insightId:o.id,messageId:a.id,content:o.content},o.id)),a.clarification&&r&&(0,H.jsx)(pt,{question:a.clarification.question,options:a.clarification.options,onSelect:r})]},a.id)}),n&&i&&(0,H.jsx)(dt,{startedAt:i})]}),ut=_n;var W=k(C()),Ae=l("react"),Z=l("react/jsx-runtime"),In=({onSend:e,disabled:n=!1,initialValue:i=""})=>{let[r,a]=(0,Ae.useState)(i),d=(0,Ae.useCallback)(()=>{let o=r.trim();!o||n||(e(o),a(""))},[r,n,e]);return(0,Z.jsxs)(W.Box,{css:{stack:"x",gap:"small",alignY:"bottom",padding:"small"},children:[(0,Z.jsx)(W.Box,{css:{width:"fill"},children:(0,Z.jsx)(W.TextArea,{label:"Ask a question",placeholder:"What's my MRR?",value:r,onChange:o=>a(o.target.value),rows:2,disabled:n})}),(0,Z.jsx)(W.Button,{type:"primary",onPress:d,disabled:n||!r.trim(),children:"Send"})]})},gt=In;var f=k(C()),w=l("react/jsx-runtime"),Pn=[{label:"What's my MRR?",value:"What's my MRR?"},{label:"How's churn trending?",value:"How is my churn rate trending over the last 3 months?"},{label:"Revenue by product",value:"What's my revenue breakdown by product?"},{label:"Top customers",value:"Who are my top 10 customers by revenue?"},{label:"Growth rate",value:"What's my MRR growth rate?"}],An=({onSelectPrompt:e,insights:n})=>(0,w.jsxs)(f.Box,{css:{padding:"medium",stack:"y",gap:"medium"},children:[(0,w.jsxs)(f.Box,{css:{stack:"y",gap:"small"},children:[(0,w.jsx)(f.Inline,{css:{font:"heading"},children:"Welcome to Javelin"}),(0,w.jsx)(f.Inline,{css:{color:"secondary"},children:"Ask me anything about your Stripe business. I can calculate metrics, analyze trends, and surface insights from your data."})]}),n&&n.length>0&&(0,w.jsxs)(f.Box,{css:{stack:"y",gap:"small"},children:[(0,w.jsx)(f.Inline,{css:{fontWeight:"semibold"},children:"Recent insights"}),n.map(i=>(0,w.jsx)(f.Box,{css:{padding:"small",backgroundColor:"container",stack:"y",gap:"xsmall"},children:(0,w.jsx)(f.Inline,{css:{color:"secondary"},children:i.content})},i.id))]}),(0,w.jsxs)(f.Box,{css:{stack:"y",gap:"small"},children:[(0,w.jsx)(f.Inline,{css:{fontWeight:"semibold"},children:"Try asking"}),(0,w.jsx)(f.Box,{css:{stack:"x",gap:"small",wrap:"wrap"},children:Pn.map(i=>(0,w.jsx)(f.Button,{type:"secondary",size:"small",onPress:()=>e(i.value),children:i.label},i.value))})]}),(0,w.jsx)(f.Box,{css:{marginTop:"small"},children:(0,w.jsx)(f.Inline,{css:{font:"caption",color:"secondary"},children:"Javelin provides informational insights only, not financial or business advice. Always verify important decisions with your own analysis."})})]}),mt=An;var I=k(C()),A=l("react/jsx-runtime"),Tn=({conversations:e,activeConversationId:n,onSelectConversation:i,onClose:r})=>e.length===0?(0,A.jsxs)(I.Box,{css:{padding:"medium",stack:"y",gap:"small",alignX:"center"},children:[(0,A.jsx)(I.Inline,{css:{color:"secondary"},children:"No conversations yet."}),(0,A.jsx)(I.Inline,{css:{color:"secondary"},children:"Start by asking a question below."})]}):(0,A.jsxs)(I.Box,{css:{stack:"y",gap:"xsmall",padding:"small"},children:[(0,A.jsxs)(I.Box,{css:{stack:"x",distribute:"space-between",alignY:"center",padding:"xsmall"},children:[(0,A.jsx)(I.Inline,{css:{fontWeight:"semibold"},children:"Conversations"}),(0,A.jsx)(I.Button,{type:"secondary",size:"small",onPress:r,children:"Close"})]}),e.map(a=>(0,A.jsx)(I.Box,{css:{padding:"small",backgroundColor:a.id===n?"container":void 0,stack:"y",gap:"xsmall"},children:(0,A.jsx)(I.Button,{type:"secondary",size:"small",onPress:()=>i(a.id),children:(0,A.jsxs)(I.Box,{css:{stack:"y",gap:"xsmall",width:"fill"},children:[(0,A.jsx)(I.Inline,{css:{fontWeight:a.id===n?"semibold":"regular"},children:a.title||"Untitled conversation"}),(0,A.jsx)(I.Inline,{css:{font:"caption",color:"secondary"},children:new Date(a.updatedAt).toLocaleDateString()})]})})},a.id))]}),ht=Tn;var y=l("react/jsx-runtime"),kn=({userContext:e,environment:n})=>{var Ue;(e==null?void 0:e.id)&&((Ue=e==null?void 0:e.account)==null?void 0:Ue.id)&&Ie(e.id,e.account.id);let[i,r]=(0,g.useState)("loading"),[a,d]=(0,g.useState)([]),[o,u]=(0,g.useState)(null),[p,v]=(0,g.useState)([]),[M,ge]=(0,g.useState)(!1),[ke,De]=(0,g.useState)(),[qe,$]=(0,g.useState)(null),[vt,St]=(0,g.useState)([]),[Ce,me]=(0,g.useState)(!1),He=(0,g.useCallback)(()=>c(void 0,null,function*(){var h;try{let N=((h=(yield E("/chat-conversations")).data)==null?void 0:h.conversations)||[];d(N),N.length===0?(Be(),r("empty")):(yield Ne(N[0].id),r("chat"))}catch(O){r("empty"),Be()}}),[]);(0,g.useEffect)(()=>{He()},[He]);let Be=()=>c(void 0,null,function*(){var h;try{let O=yield E("/insights-welcome");St(((h=O.data)==null?void 0:h.insights)||[])}catch(O){}}),Ne=h=>c(void 0,null,function*(){var O;try{let fe=(((O=(yield E(`/chat-conversation-detail?conversationId=${h}`)).data)==null?void 0:O.messages)||[]).map(L=>{var Q,ee;return{id:L.id,role:L.role,content:L.content,freshness:(Q=L.metadata)==null?void 0:Q.freshness,insights:(ee=L.metadata)==null?void 0:ee.insights}});v(fe),u(h)}catch(N){$("Failed to load conversation")}}),he=(0,g.useCallback)(h=>c(void 0,null,function*(){var fe,L,Q,ee,Ke;$(null);let N={id:`temp-${Date.now()}`,role:"user",content:h};v(x=>[...x,N]),r("chat"),ge(!0),De(Date.now());try{let x=yield E("/chat-message",{method:"POST",body:{conversationId:o,content:h}}),te={id:((fe=x.data)==null?void 0:fe.message.id)||`msg-${Date.now()}`,role:"assistant",content:((L=x.data)==null?void 0:L.message.content)||"Sorry, I could not generate a response.",freshness:x.meta,insights:(Q=x.data)==null?void 0:Q.insights};((ee=x.data)==null?void 0:ee.conversationId)&&!o&&u(x.data.conversationId),v(ye=>[...ye,te])}catch(x){let te=x,ye=(Ke=te==null?void 0:te.error)==null?void 0:Ke.code;$(ye==="auth_refresh_failed"?"Your session has expired. Please re-authorize Javelin.":ye==="llm_unavailable"?"AI service is temporarily unavailable. Please try again in a moment.":"Something went wrong. Please try again.")}finally{ge(!1),De(void 0)}}),[o]),wt=(0,g.useCallback)(h=>{he(h)},[he]),_t=(0,g.useCallback)(()=>{u(null),v([]),r("empty"),me(!1),Be()},[]),It=(0,g.useCallback)(h=>c(void 0,null,function*(){me(!1),yield Ne(h),r("chat")}),[]);return i==="loading"?(0,y.jsx)(b.ContextView,{title:"Javelin",children:(0,y.jsxs)(b.Box,{css:{padding:"medium",stack:"y",gap:"medium",alignX:"center"},children:[(0,y.jsx)(b.Spinner,{}),(0,y.jsx)(b.Inline,{css:{color:"secondary"},children:"Loading Javelin..."})]})}):(0,y.jsx)(b.ContextView,{title:"Javelin",actions:(0,y.jsxs)(b.Box,{css:{stack:"x",gap:"small"},children:[a.length>0&&(0,y.jsx)(b.Button,{type:"secondary",onPress:()=>me(h=>!h),children:"History"}),(0,y.jsx)(b.Button,{type:"secondary",onPress:_t,children:"New chat"})]}),children:(0,y.jsxs)(b.Box,{css:{stack:"y",height:"fill"},children:[qe&&(0,y.jsx)(b.Banner,{type:"critical",title:"Error",description:qe,onDismiss:()=>$(null)}),Ce&&(0,y.jsx)(ht,{conversations:a,activeConversationId:o,onSelectConversation:It,onClose:()=>me(!1)}),!Ce&&(0,y.jsx)(b.Box,{css:{stack:"y",overflow:"auto"},children:i==="empty"&&p.length===0?(0,y.jsx)(mt,{onSelectPrompt:he,insights:vt}):(0,y.jsx)(ut,{messages:p,isThinking:M,thinkingStartedAt:ke,onClarificationSelect:wt})}),!Ce&&(0,y.jsx)(gt,{onSend:he,disabled:M})]})})},ft=kn;var X=k(C()),Te=l("react/jsx-runtime"),Cn=({userContext:e})=>(0,Te.jsx)(X.SettingsView,{children:(0,Te.jsx)(X.Box,{css:{padding:"medium"},children:(0,Te.jsx)(X.Inline,{children:"Javelin settings coming soon."})})}),yt=Cn;var P=k(C()),J=l("react");var m=l("react/jsx-runtime"),Bn=({userContext:e,oauthContext:n})=>{var u;(e==null?void 0:e.id)&&((u=e==null?void 0:e.account)==null?void 0:u.id)&&Ie(e.id,e.account.id);let[i,r]=(0,J.useState)("processing"),[a,d]=(0,J.useState)(""),o=(0,J.useCallback)(()=>c(void 0,null,function*(){if(n!=null&&n.error){r("error"),d(`Authorization failed: ${n.error}`);return}if(!(n!=null&&n.code)){r("error"),d("No authorization code received. Please try installing again.");return}try{yield E("/auth-callback",{method:"POST",body:{code:n.code,state:n.state||"",verifier:n.verifier||""}}),yield E("/sync-trigger",{method:"POST",body:{}}),r("success")}catch(p){r("error"),d("Failed to complete setup. Please try again.")}}),[n]);return(0,J.useEffect)(()=>{o()},[o]),(0,m.jsx)(P.ContextView,{title:"Welcome to Javelin",children:(0,m.jsxs)(P.Box,{css:{padding:"medium",stack:"y",gap:"medium",alignX:"center"},children:[i==="processing"&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(P.Spinner,{}),(0,m.jsx)(P.Inline,{children:"Setting up Javelin..."}),(0,m.jsx)(P.Inline,{css:{color:"secondary"},children:"Connecting to your Stripe account and syncing your data."})]}),i==="success"&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(P.Banner,{type:"default",title:"Setup complete!",description:"Javelin is ready. Your data is syncing in the background \u2014 you can start asking questions right away."}),(0,m.jsx)(P.Inline,{css:{color:"secondary"},children:"Open the Javelin drawer from any page in your Stripe Dashboard to get started."})]}),i==="error"&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(P.Banner,{type:"critical",title:"Setup failed",description:a}),(0,m.jsx)(P.Button,{type:"primary",onPress:o,children:"Retry"})]})]})})},bt=Bn;D(R,k(xe()));var xn="2026-02-12 17:00:22.482665 -0300 -03 m=+31.542380935";var En={allowed_redirect_uris:["https://dashboard.stripe.com/test/apps-oauth/com.javelin.analytics","https://dashboard.stripe.com/apps-oauth/com.javelin.analytics"],connect_permissions:null,distribution_type:"private",icon:"./icon.png",id:"com.javelin.analytics",name:"Javelin",permissions:[{permission:"customer_read",purpose:"Read customer data to calculate business metrics and answer questions about your customer base"},{permission:"invoice_read",purpose:"Read invoice data to calculate revenue, MRR, and other billing metrics"},{permission:"charge_read",purpose:"Read charge data to analyze payment volume and revenue trends"},{permission:"subscription_read",purpose:"Read subscription data to calculate MRR, churn rate, and subscription analytics"},{permission:"product_read",purpose:"Read product data to break down revenue and metrics by product"},{permission:"plan_read",purpose:"Read price and plan data to analyze plan-level revenue and subscriber counts"},{permission:"secret_write",purpose:"Store and manage OAuth tokens securely via the Secret Store API"}],sandbox_install_compatible:!0,stripe_api_access_type:"oauth",ui_extension:{content_security_policy:{"connect-src":["https://tecvycpmzcxxoqmtttjy.supabase.co/functions/v1/","https://openrouter.ai/api/","https://api.openai.com/v1/"],"image-src":null,purpose:"Connect to Supabase backend for data processing and LLM provider for AI-powered business intelligence"},views:[{component:"ChatView",viewport:"stripe.dashboard.drawer.default"},{component:"SettingsView",viewport:"settings"},{component:"OnboardingView",viewport:"onboarding"}]},version:"0.0.3"};return Mt(R);})();
//# sourceMappingURL=ext.min.js.map
