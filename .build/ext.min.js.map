{
  "version": 3,
  "sources": ["../node_modules/@stripe/ui-extension-sdk/version.js", "../node_modules/@stripe/ui-extension-sdk/ui/index.js", "../node_modules/invariant/browser.js", "../node_modules/@stripe/ui-extension-sdk/utils/_endpoint.js", "../node_modules/@stripe/ui-extension-sdk/utils/api/supportsFetchAppEmbeddedKey.js", "../node_modules/@stripe/ui-extension-sdk/utils/api/fetchAppEmbeddedKey.js", "../node_modules/@stripe/ui-extension-sdk/utils/api/fetchViaFrame.js", "../node_modules/@stripe/ui-extension-sdk/utils/api/fetchViaHost.js", "../node_modules/@stripe/ui-extension-sdk/utils/api/selectPreferredStripeApiFetch.js", "../node_modules/@stripe/ui-extension-sdk/utils/api/index.js", "../node_modules/@stripe/ui-extension-sdk/utils/apiFetch.js", "../node_modules/@stripe/ui-extension-sdk/utils/httpClient.js", "../node_modules/@stripe/ui-extension-sdk/utils/signature/createFetchStripeSignatureDirectly.js", "../node_modules/@stripe/ui-extension-sdk/utils/signature/connectionSettings.js", "../node_modules/@stripe/ui-extension-sdk/utils/signature.js", "../node_modules/@stripe/ui-extension-sdk/signature.js", "manifest.js", "../src/views/ChatView.tsx", "../src/components/ChatThread.tsx", "../src/components/MessageBubble.tsx", "../src/components/InsightCard.tsx", "../src/lib/api-client.ts", "../src/components/ThinkingIndicator.tsx", "../src/components/ClarificationPrompt.tsx", "../src/components/ChatInput.tsx", "../src/components/WelcomePrompt.tsx", "../src/components/ConversationList.tsx", "../src/views/SettingsView.tsx", "../src/views/OnboardingView.tsx"],
  "sourcesContent": ["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SDK_VERSION = void 0;\nexports.SDK_VERSION = '9.1.0';\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TableHeaderCell = exports.TableHead = exports.TableFooter = exports.TableCell = exports.TableBody = exports.Tab = exports.TabPanels = exports.TabPanel = exports.TabList = exports.Switch = exports.StripeFileUploader = exports.Spinner = exports.Sparkline = exports.SignInView = exports.SettingsView = exports.Select = exports.Radio = exports.PropertyList = exports.PropertyListItem = exports.PlatformConfigurationView = exports.OnboardingView = exports.Menu = exports.MenuItem = exports.MenuGroup = exports.List = exports.ListItem = exports.Link = exports.LineChart = exports.Inline = exports.Img = exports.Icon = exports.FormFieldGroup = exports.FocusView = exports.Divider = exports.DetailPageTable = exports.DetailPagePropertyList = exports.DetailPageModule = exports.DateField = exports.ContextView = exports.Chip = exports.ChipList = exports.Checkbox = exports.Button = exports.ButtonGroup = exports.Box = exports.BarChart = exports.Banner = exports.Badge = exports.Accordion = exports.AccordionItem = void 0;\nexports.Tooltip = exports.TextField = exports.TextArea = exports.TaskList = exports.TaskListItem = exports.Tabs = exports.TableRow = exports.Table = void 0;\nconst jsx_runtime_1 = require(\"react/jsx-runtime\");\nconst react_1 = require(\"@remote-ui/react\");\nconst version_1 = require(\"../version\");\nconst withSdkProps = (Component) => {\n    const wrappedComponentName = Component.displayName || Component.toString();\n    const WithSdkProps = (props) => ((0, jsx_runtime_1.jsx)(Component, { ...props, wrappedComponentName: wrappedComponentName, sdkVersion: version_1.SDK_VERSION, schemaVersion: \"v9\" }));\n    WithSdkProps.wrappedComponentName = wrappedComponentName;\n    return WithSdkProps;\n};\nconst defineComponent = (name, fragmentProps, wrapWithSdkProps) => {\n    const remoteComponent = (0, react_1.createRemoteReactComponent)(name, {\n        fragmentProps,\n    });\n    if (!wrapWithSdkProps) {\n        return remoteComponent;\n    }\n    return withSdkProps(remoteComponent);\n};\nexports.AccordionItem = defineComponent('AccordionItem', ['title', 'actions', 'media', 'subtitle'], true);\nexports.Accordion = defineComponent('Accordion', [], true);\nexports.Badge = defineComponent('Badge', [], true);\nexports.Banner = defineComponent('Banner', ['actions', 'description', 'title'], true);\nexports.BarChart = defineComponent('BarChart', [], true);\nexports.Box = defineComponent('Box', [], true);\nexports.ButtonGroup = defineComponent('ButtonGroup', ['menuTrigger'], true);\nexports.Button = defineComponent('Button', [], true);\nexports.Checkbox = defineComponent('Checkbox', ['label'], true);\nexports.ChipList = defineComponent('ChipList', [], true);\nexports.Chip = defineComponent('Chip', [], true);\nexports.ContextView = defineComponent('ContextView', ['actions', 'banner', 'footerContent', 'primaryAction', 'secondaryAction'], true);\nexports.DateField = defineComponent('DateField', ['label'], true);\nexports.DetailPageModule = defineComponent('DetailPageModule', [], true);\nexports.DetailPagePropertyList = defineComponent('DetailPagePropertyList', [], true);\nexports.DetailPageTable = defineComponent('DetailPageTable', [], true);\nexports.Divider = defineComponent('Divider', [], true);\nexports.FocusView = defineComponent('FocusView', ['footerContent', 'primaryAction', 'secondaryAction'], true);\nexports.FormFieldGroup = defineComponent('FormFieldGroup', [], true);\nexports.Icon = defineComponent('Icon', [], true);\nexports.Img = defineComponent('Img', [], true);\nexports.Inline = defineComponent('Inline', [], true);\nexports.LineChart = defineComponent('LineChart', [], true);\nexports.Link = defineComponent('Link', [], true);\nexports.ListItem = defineComponent('ListItem', ['icon', 'image', 'secondaryTitle', 'title', 'value'], true);\nexports.List = defineComponent('List', [], true);\nexports.MenuGroup = defineComponent('MenuGroup', ['title'], true);\nexports.MenuItem = defineComponent('MenuItem', [], true);\nexports.Menu = defineComponent('Menu', ['trigger'], true);\nexports.OnboardingView = defineComponent('OnboardingView', ['error'], true);\nexports.PlatformConfigurationView = defineComponent('PlatformConfigurationView', [], true);\nexports.PropertyListItem = defineComponent('PropertyListItem', ['label', 'value'], true);\nexports.PropertyList = defineComponent('PropertyList', [], true);\nexports.Radio = defineComponent('Radio', ['label'], true);\nexports.Select = defineComponent('Select', ['label'], true);\nexports.SettingsView = defineComponent('SettingsView', [], true);\nexports.SignInView = defineComponent('SignInView', ['descriptionActionContents', 'footerContent'], true);\nexports.Sparkline = defineComponent('Sparkline', [], true);\nexports.Spinner = defineComponent('Spinner', [], true);\nexports.StripeFileUploader = defineComponent('StripeFileUploader', [], true);\nexports.Switch = defineComponent('Switch', ['label'], true);\nexports.TabList = defineComponent('TabList', [], true);\nexports.TabPanel = defineComponent('TabPanel', [], true);\nexports.TabPanels = defineComponent('TabPanels', [], true);\nexports.Tab = defineComponent('Tab', [], true);\nexports.TableBody = defineComponent('TableBody', [], true);\nexports.TableCell = defineComponent('TableCell', [], true);\nexports.TableFooter = defineComponent('TableFooter', [], true);\nexports.TableHead = defineComponent('TableHead', [], true);\nexports.TableHeaderCell = defineComponent('TableHeaderCell', [], true);\nexports.Table = defineComponent('Table', [], true);\nexports.TableRow = defineComponent('TableRow', [], true);\nexports.Tabs = defineComponent('Tabs', [], true);\nexports.TaskListItem = defineComponent('TaskListItem', [], true);\nexports.TaskList = defineComponent('TaskList', [], true);\nexports.TextArea = defineComponent('TextArea', ['label'], true);\nexports.TextField = defineComponent('TextField', ['label'], true);\nexports.Tooltip = defineComponent('Tooltip', ['trigger'], true);\n", "/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar invariant = function(condition, format, a, b, c, d, e, f) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n};\n\nmodule.exports = invariant;\n", "\"use strict\";\n/**\n * Private! This allows the shared endpoint to be intialized\n * so that the SDK can communicate with the Dashboard.\n */\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getHostEndpoint = void 0;\nconst invariant_1 = __importDefault(require(\"invariant\"));\nconst getHostEndpoint = () => {\n    // This is endpoint is created from the MessagePort transferred from the host env\n    // as a part of the `init_extension` message.\n    const hostEndpoint = globalThis.__StripeExtExports?.endpoint;\n    (0, invariant_1.default)(hostEndpoint, 'hostEndpoint has not been initialized');\n    return hostEndpoint;\n};\nexports.getHostEndpoint = getHostEndpoint;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.supportsFetchAppEmbeddedKey = void 0;\nconst _endpoint_1 = require(\"../_endpoint\");\nconst supportsFetchAppEmbeddedKey = async () => (0, _endpoint_1.getHostEndpoint)()\n    .call.supportsFetchAppEmbeddedKey()\n    .then((supported) => supported)\n    .catch(() => false);\nexports.supportsFetchAppEmbeddedKey = supportsFetchAppEmbeddedKey;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fetchAppEmbeddedKey = void 0;\nconst _endpoint_1 = require(\"../_endpoint\");\nconst fetchAppEmbeddedKey = async () => {\n    const apiKey = await (0, _endpoint_1.getHostEndpoint)().call.fetchAppEmbeddedKey();\n    if (!apiKey) {\n        throw new Error('Unable to fetch app embedded key');\n    }\n    return apiKey;\n};\nexports.fetchAppEmbeddedKey = fetchAppEmbeddedKey;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fetchViaFrame = void 0;\nconst fetchAppEmbeddedKey_1 = require(\"./fetchAppEmbeddedKey\");\nconst fetchViaFrame = async (url, options = {}) => {\n    const apiKey = await (0, fetchAppEmbeddedKey_1.fetchAppEmbeddedKey)();\n    const init = {\n        ...options,\n        headers: {\n            ...options.headers,\n            Authorization: `Bearer ${apiKey}`,\n        },\n    };\n    const response = await fetch(url, init);\n    const headers = {};\n    response.headers.forEach((value, key) => {\n        headers[key] = value;\n    });\n    const serializableResponse = {\n        json: undefined,\n        arrayBuffer: undefined,\n        headers,\n        ok: response.ok,\n        redirected: response.redirected,\n        status: response.status,\n        statusText: response.statusText,\n        type: response.type,\n        url: response.url,\n    };\n    switch (response.headers.get('Content-Type')) {\n        case 'application/json':\n            serializableResponse.json = await response.json();\n            break;\n        default:\n            serializableResponse.arrayBuffer = await response.arrayBuffer();\n            break;\n    }\n    return serializableResponse;\n};\nexports.fetchViaFrame = fetchViaFrame;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fetchViaHost = void 0;\nconst _endpoint_1 = require(\"../_endpoint\");\nconst fetchViaHost = async (encodedUrl, options = {}) => {\n    const url = new URL(encodedUrl);\n    return (0, _endpoint_1.getHostEndpoint)().call.stripeApiFetch(url.pathname + url.search, options);\n};\nexports.fetchViaHost = fetchViaHost;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.selectPreferredStripeApiFetch = void 0;\nconst supportsFetchAppEmbeddedKey_1 = require(\"./supportsFetchAppEmbeddedKey\");\nconst fetchViaFrame_1 = require(\"./fetchViaFrame\");\nconst fetchViaHost_1 = require(\"./fetchViaHost\");\nlet selectedStripeApiFetch = null;\nconst selectPreferredStripeApiFetch = async () => {\n    if (!selectedStripeApiFetch) {\n        selectedStripeApiFetch = (await (0, supportsFetchAppEmbeddedKey_1.supportsFetchAppEmbeddedKey)())\n            ? fetchViaFrame_1.fetchViaFrame\n            : fetchViaHost_1.fetchViaHost;\n    }\n    return selectedStripeApiFetch;\n};\nexports.selectPreferredStripeApiFetch = selectPreferredStripeApiFetch;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.selectPreferredStripeApiFetch = void 0;\nvar selectPreferredStripeApiFetch_1 = require(\"./selectPreferredStripeApiFetch\");\nObject.defineProperty(exports, \"selectPreferredStripeApiFetch\", { enumerable: true, get: function () { return selectPreferredStripeApiFetch_1.selectPreferredStripeApiFetch; } });\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.stripeApiFetch = void 0;\nconst api_1 = require(\"./api\");\nconst stripeApiFetch = async (path, options) => {\n    const preferredFetchMethod = await (0, api_1.selectPreferredStripeApiFetch)();\n    return preferredFetchMethod(path, options);\n};\nexports.stripeApiFetch = stripeApiFetch;\n", "\"use strict\";\n/* eslint-disable max-classes-per-file */\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AUTHORIZATION_VALUE = exports.AUTHORIZATION_HEADER = exports.createHttpClient = exports.STRIPE_API_KEY = exports.StripeAppsHttpClient = void 0;\n/**\n * This module provides a HttpClient that can be plugged into stripe-node\n * that will allow the user to use stripe-node in extensions if the Dashboard\n * provides a `stripeApiFetch` function that will relay API calls through the\n * Dashboard and piggy back on the user's Dashboard session.\n */\nconst invariant_1 = __importDefault(require(\"invariant\"));\nconst apiFetch_1 = require(\"./apiFetch\");\nconst matchesStripeKey = /[ps]k_(test|live)_[A-Za-z0-9]+/;\nclass StripeAppsHttpResponse {\n    constructor(resp) {\n        this._resp = resp;\n    }\n    getHeaders() {\n        return this._resp.headers;\n    }\n    getStatusCode() {\n        return this._resp.status;\n    }\n    getRawResponse() {\n        return this._resp;\n    }\n    // eslint-disable-next-line class-methods-use-this\n    toStream() {\n        throw new Error('Streams have not been implemented in the Stripe HTTP client');\n    }\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    toJSON() {\n        const { json } = this._resp;\n        if (json === undefined) {\n            return Promise.reject(new Error('Response body undefined'));\n        }\n        else {\n            return Promise.resolve(json);\n        }\n    }\n}\nclass StripeAppsHttpClient {\n    constructor(fetch) {\n        this._fetch = fetch;\n    }\n    // eslint-disable-next-line class-methods-use-this\n    getClientName() {\n        return 'stripe-ui-extension';\n    }\n    async makeRequest(host, port, path, method, headers, requestData, protocol, _timeout) {\n        (0, invariant_1.default)(protocol === 'https', 'Must use https connections in UI extensions');\n        const fetchOptions = {\n            method,\n            headers,\n        };\n        if (requestData) {\n            fetchOptions.body = requestData;\n        }\n        const authHeader = headers.Authorization;\n        if (authHeader && matchesStripeKey.test(authHeader)) {\n            throw new Error('Do not use actual stripe keys when using the Stripe JS API client with UI extesions.\\n\\n Instead, use `STRIPE_API_KEY` from `@stripe/ui-extension-sdk/http_client` as a placeholder.');\n        }\n        const url = new URL(path, `${protocol}://${host}`);\n        const resp = await this._fetch(url.toString(), fetchOptions);\n        // TODO: Add support for timeouts.\n        return new StripeAppsHttpResponse(resp);\n    }\n}\nexports.StripeAppsHttpClient = StripeAppsHttpClient;\n// DO NOT change this string without a deprecation plan. The runtime checks to make sure that this\n// exact string is passed, otherwise it will throw an error.\n// See: manage/frontend/src/tailor/extensions/host/api_fetch.js\nexports.STRIPE_API_KEY = 'DO_NOT_PASS_A_REAL_API_KEY';\nconst createHttpClient = () => new StripeAppsHttpClient(apiFetch_1.stripeApiFetch);\nexports.createHttpClient = createHttpClient;\nexports.AUTHORIZATION_HEADER = 'Authorization';\nexports.AUTHORIZATION_VALUE = `Bearer ${exports.STRIPE_API_KEY}`;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createFetchStripeSignatureDirectly = void 0;\nconst httpClient_1 = require(\"../httpClient\");\nconst createFetchStripeSignatureDirectly = ({ host, port }) => async (payload) => {\n    const url = new URL(`https://${host}:${port}/v1/apps/app_embedded_backend_signature`);\n    url.searchParams.set('payload', JSON.stringify({ ...payload }));\n    url.searchParams.set('include_only[]', 'signature');\n    const client = (0, httpClient_1.createHttpClient)();\n    const response = client.makeRequest(host, port, url.pathname + url.search, 'GET', {}, null, 'https');\n    return response\n        .then((r) => r.toJSON())\n        .then((data) => data.signature);\n};\nexports.createFetchStripeSignatureDirectly = createFetchStripeSignatureDirectly;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.setConnectionSettings = exports.connectionSettings = void 0;\nconst defaultConnectionSettings = {\n    host: 'api.stripe.com',\n    port: 443,\n};\n// eslint-disable-next-line import/no-mutable-exports\nexports.connectionSettings = defaultConnectionSettings;\nconst setConnectionSettings = (settings) => {\n    exports.connectionSettings = {\n        ...defaultConnectionSettings,\n        ...settings,\n    };\n};\nexports.setConnectionSettings = setConnectionSettings;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fetchStripeSignature = void 0;\nconst createFetchStripeSignatureDirectly_1 = require(\"./signature/createFetchStripeSignatureDirectly\");\nconst supportsFetchAppEmbeddedKey_1 = require(\"./api/supportsFetchAppEmbeddedKey\");\nconst connectionSettings_1 = require(\"./signature/connectionSettings\");\nconst _endpoint_1 = require(\"./_endpoint\");\nconst fetchStripeSignature = async (additionalPayload) => {\n    if (await (0, supportsFetchAppEmbeddedKey_1.supportsFetchAppEmbeddedKey)()) {\n        const fetchStripeSignatureDirectly = (0, createFetchStripeSignatureDirectly_1.createFetchStripeSignatureDirectly)(connectionSettings_1.connectionSettings);\n        return fetchStripeSignatureDirectly(additionalPayload);\n    }\n    else {\n        return (0, _endpoint_1.getHostEndpoint)().call.fetchStripeSignature(additionalPayload);\n    }\n};\nexports.fetchStripeSignature = fetchStripeSignature;\n", "\"use strict\";\n// This file moved to utils; re-exported to not break imports\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst signature_1 = require(\"./utils/signature\");\nexports.default = signature_1.fetchStripeSignature;\n", "// AUTOGENERATED - DO NOT MODIFY\nimport ChatView from '../src/views/ChatView';import SettingsView from '../src/views/SettingsView';import OnboardingView from '../src/views/OnboardingView';\n\nexport * from '@stripe/ui-extension-sdk/version';\nexport const BUILD_TIME = '2026-02-12 17:00:22.482665 -0300 -03 m=+31.542380935';\n\nexport { \n  ChatView,\t\n\n  SettingsView,\t\n\n  OnboardingView\t\n };\n\nexport default {\n  \"allowed_redirect_uris\": [\n    \"https://dashboard.stripe.com/test/apps-oauth/com.javelin.analytics\",\n    \"https://dashboard.stripe.com/apps-oauth/com.javelin.analytics\"\n  ],\n  \"connect_permissions\": null,\n  \"distribution_type\": \"private\",\n  \"icon\": \"./icon.png\",\n  \"id\": \"com.javelin.analytics\",\n  \"name\": \"Javelin\",\n  \"permissions\": [\n    {\n      \"permission\": \"customer_read\",\n      \"purpose\": \"Read customer data to calculate business metrics and answer questions about your customer base\"\n    },\n    {\n      \"permission\": \"invoice_read\",\n      \"purpose\": \"Read invoice data to calculate revenue, MRR, and other billing metrics\"\n    },\n    {\n      \"permission\": \"charge_read\",\n      \"purpose\": \"Read charge data to analyze payment volume and revenue trends\"\n    },\n    {\n      \"permission\": \"subscription_read\",\n      \"purpose\": \"Read subscription data to calculate MRR, churn rate, and subscription analytics\"\n    },\n    {\n      \"permission\": \"product_read\",\n      \"purpose\": \"Read product data to break down revenue and metrics by product\"\n    },\n    {\n      \"permission\": \"plan_read\",\n      \"purpose\": \"Read price and plan data to analyze plan-level revenue and subscriber counts\"\n    },\n    {\n      \"permission\": \"secret_write\",\n      \"purpose\": \"Store and manage OAuth tokens securely via the Secret Store API\"\n    }\n  ],\n  \"sandbox_install_compatible\": true,\n  \"stripe_api_access_type\": \"oauth\",\n  \"ui_extension\": {\n    \"content_security_policy\": {\n      \"connect-src\": [\n        \"https://tecvycpmzcxxoqmtttjy.supabase.co/functions/v1/\",\n        \"https://openrouter.ai/api/\",\n        \"https://api.openai.com/v1/\"\n      ],\n      \"image-src\": null,\n      \"purpose\": \"Connect to Supabase backend for data processing and LLM provider for AI-powered business intelligence\"\n    },\n    \"views\": [\n      {\n        \"component\": \"ChatView\",\n        \"viewport\": \"stripe.dashboard.drawer.default\"\n      },\n      {\n        \"component\": \"SettingsView\",\n        \"viewport\": \"settings\"\n      },\n      {\n        \"component\": \"OnboardingView\",\n        \"viewport\": \"onboarding\"\n      }\n    ]\n  },\n  \"version\": \"0.0.3\"\n};\n", "import { ContextView, Box, Spinner, Inline, Banner, Button } from '@stripe/ui-extension-sdk/ui';\nimport type { ExtensionContextValue } from '@stripe/ui-extension-sdk/context';\nimport { useState, useEffect, useCallback } from 'react';\nimport ChatThread from '../components/ChatThread';\nimport ChatInput from '../components/ChatInput';\nimport WelcomePrompt from '../components/WelcomePrompt';\nimport ConversationList from '../components/ConversationList';\nimport { apiClient, initApiClient } from '../lib/api-client';\n\ninterface Message {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  freshness?: { type: 'cached' | 'live'; syncedAt?: string };\n  insights?: Array<{ id: string; content: string }>;\n  clarification?: {\n    question: string;\n    options: Array<{ label: string; value: string }>;\n  };\n}\n\ninterface Conversation {\n  id: string;\n  title: string;\n  updatedAt: string;\n}\n\ntype ViewState = 'loading' | 'empty' | 'chat' | 'error';\n\nconst ChatView = ({ userContext, environment: _environment }: ExtensionContextValue) => {\n  // Initialize API client with Stripe context for signature verification\n  if (userContext?.id && userContext?.account?.id) {\n    initApiClient(userContext.id, userContext.account.id);\n  }\n  const [viewState, setViewState] = useState<ViewState>('loading');\n  const [conversations, setConversations] = useState<Conversation[]>([]);\n  const [activeConversationId, setActiveConversationId] = useState<string | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [isThinking, setIsThinking] = useState(false);\n  const [thinkingStartedAt, setThinkingStartedAt] = useState<number | undefined>();\n  const [error, setError] = useState<string | null>(null);\n  const [welcomeInsights, setWelcomeInsights] = useState<Array<{ id: string; content: string }>>([]);\n  const [showConversationList, setShowConversationList] = useState(false);\n\n  const loadConversations = useCallback(async () => {\n    try {\n      const response = await apiClient<{ conversations: Conversation[] }>('/chat-conversations');\n      const convos = response.data?.conversations || [];\n      setConversations(convos);\n\n      if (convos.length === 0) {\n        // First time user \u2014 load welcome insights\n        loadWelcomeInsights();\n        setViewState('empty');\n      } else {\n        // Load the most recent conversation\n        await loadConversation(convos[0].id);\n        setViewState('chat');\n      }\n    } catch {\n      // If conversations fail to load, show empty state (could be first time)\n      setViewState('empty');\n      loadWelcomeInsights();\n    }\n  }, []);\n\n  // Load conversations on mount\n  useEffect(() => {\n    loadConversations();\n  }, [loadConversations]);\n\n  const loadWelcomeInsights = async () => {\n    try {\n      const response = await apiClient<{ insights: Array<{ id: string; content: string }> }>(\n        '/insights-welcome',\n      );\n      setWelcomeInsights(response.data?.insights || []);\n    } catch {\n      // Non-critical \u2014 just show empty welcome\n    }\n  };\n\n  const loadConversation = async (conversationId: string) => {\n    try {\n      const response = await apiClient<{\n        conversation: Conversation;\n        messages: Array<{\n          id: string;\n          role: 'user' | 'assistant';\n          content: string;\n          metadata?: Record<string, unknown>;\n        }>;\n      }>(`/chat-conversation-detail?conversationId=${conversationId}`);\n\n      const msgs: Message[] = (response.data?.messages || []).map((m) => ({\n        id: m.id,\n        role: m.role,\n        content: m.content,\n        freshness: m.metadata?.freshness as Message['freshness'],\n        insights: m.metadata?.insights as Message['insights'],\n      }));\n\n      setMessages(msgs);\n      setActiveConversationId(conversationId);\n    } catch {\n      setError('Failed to load conversation');\n    }\n  };\n\n  const sendMessage = useCallback(\n    async (content: string) => {\n      setError(null);\n\n      // Add user message to UI immediately\n      const tempUserMsgId = `temp-${Date.now()}`;\n      const userMessage: Message = {\n        id: tempUserMsgId,\n        role: 'user',\n        content,\n      };\n      setMessages((prev) => [...prev, userMessage]);\n      setViewState('chat');\n      setIsThinking(true);\n      setThinkingStartedAt(Date.now());\n\n      try {\n        const response = await apiClient<{\n          message: {\n            id: string;\n            content: string;\n            metadata?: Record<string, unknown>;\n          };\n          insights?: Array<{ id: string; content: string }>;\n          conversationId: string;\n        }>('/chat-message', {\n          method: 'POST',\n          body: {\n            conversationId: activeConversationId,\n            content,\n          },\n        });\n\n        const assistantMessage: Message = {\n          id: response.data?.message.id || `msg-${Date.now()}`,\n          role: 'assistant',\n          content: response.data?.message.content || 'Sorry, I could not generate a response.',\n          freshness: response.meta as Message['freshness'],\n          insights: response.data?.insights,\n        };\n\n        // Update conversation ID if new conversation was created\n        if (response.data?.conversationId && !activeConversationId) {\n          setActiveConversationId(response.data.conversationId);\n        }\n\n        setMessages((prev) => [...prev, assistantMessage]);\n      } catch (err: unknown) {\n        const errorObj = err as { error?: { code?: string; message?: string } };\n        const code = errorObj?.error?.code;\n\n        if (code === 'auth_refresh_failed') {\n          setError('Your session has expired. Please re-authorize Javelin.');\n          // In a full implementation, this would switch to SignInView\n        } else if (code === 'llm_unavailable') {\n          setError('AI service is temporarily unavailable. Please try again in a moment.');\n        } else {\n          setError('Something went wrong. Please try again.');\n        }\n      } finally {\n        setIsThinking(false);\n        setThinkingStartedAt(undefined);\n      }\n    },\n    [activeConversationId],\n  );\n\n  const handleClarificationSelect = useCallback(\n    (value: string) => {\n      sendMessage(value);\n    },\n    [sendMessage],\n  );\n\n  const handleNewConversation = useCallback(() => {\n    setActiveConversationId(null);\n    setMessages([]);\n    setViewState('empty');\n    setShowConversationList(false);\n    loadWelcomeInsights();\n  }, []);\n\n  const handleSelectConversation = useCallback(async (id: string) => {\n    setShowConversationList(false);\n    await loadConversation(id);\n    setViewState('chat');\n  }, []);\n\n  // Loading state\n  if (viewState === 'loading') {\n    return (\n      <ContextView title=\"Javelin\">\n        <Box css={{ padding: 'medium', stack: 'y', gap: 'medium', alignX: 'center' }}>\n          <Spinner />\n          <Inline css={{ color: 'secondary' }}>Loading Javelin...</Inline>\n        </Box>\n      </ContextView>\n    );\n  }\n\n  return (\n    <ContextView\n      title=\"Javelin\"\n      actions={\n        <Box css={{ stack: 'x', gap: 'small' }}>\n          {conversations.length > 0 && (\n            <Button type=\"secondary\" onPress={() => setShowConversationList((v) => !v)}>\n              History\n            </Button>\n          )}\n          <Button type=\"secondary\" onPress={handleNewConversation}>\n            New chat\n          </Button>\n        </Box>\n      }\n    >\n      <Box css={{ stack: 'y', height: 'fill' }}>\n        {/* Error banner */}\n        {error && (\n          <Banner\n            type=\"critical\"\n            title=\"Error\"\n            description={error}\n            onDismiss={() => setError(null)}\n          />\n        )}\n\n        {/* Conversation list panel */}\n        {showConversationList && (\n          <ConversationList\n            conversations={conversations}\n            activeConversationId={activeConversationId}\n            onSelectConversation={handleSelectConversation}\n            onClose={() => setShowConversationList(false)}\n          />\n        )}\n\n        {/* Main content area */}\n        {!showConversationList && <Box css={{ stack: 'y', overflow: 'auto' }}>\n          {viewState === 'empty' && messages.length === 0 ? (\n            <WelcomePrompt onSelectPrompt={sendMessage} insights={welcomeInsights} />\n          ) : (\n            <ChatThread\n              messages={messages}\n              isThinking={isThinking}\n              thinkingStartedAt={thinkingStartedAt}\n              onClarificationSelect={handleClarificationSelect}\n            />\n          )}\n        </Box>}\n\n        {/* Chat input */}\n        {!showConversationList && <ChatInput onSend={sendMessage} disabled={isThinking} />}\n      </Box>\n    </ContextView>\n  );\n};\n\nexport default ChatView;\n", "import { Box } from '@stripe/ui-extension-sdk/ui';\nimport MessageBubble from './MessageBubble';\nimport InsightCard from './InsightCard';\nimport ThinkingIndicator from './ThinkingIndicator';\nimport ClarificationPrompt from './ClarificationPrompt';\n\ninterface Message {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  freshness?: { type: 'cached' | 'live'; syncedAt?: string };\n  insights?: Array<{ id: string; content: string }>;\n  clarification?: {\n    question: string;\n    options: Array<{ label: string; value: string }>;\n  };\n}\n\ninterface ChatThreadProps {\n  messages: Message[];\n  isThinking: boolean;\n  thinkingStartedAt?: number;\n  onClarificationSelect?: (value: string) => void;\n}\n\nconst ChatThread = ({\n  messages,\n  isThinking,\n  thinkingStartedAt,\n  onClarificationSelect,\n}: ChatThreadProps) => {\n  return (\n    <Box css={{ stack: 'y', gap: 'xsmall', overflow: 'auto' }}>\n      {messages.map((message) => (\n        <Box key={message.id} css={{ stack: 'y' }}>\n          <MessageBubble\n            role={message.role}\n            content={message.content}\n            freshness={message.freshness}\n          />\n          {message.insights?.map((insight) => (\n            <InsightCard\n              key={insight.id}\n              insightId={insight.id}\n              messageId={message.id}\n              content={insight.content}\n            />\n          ))}\n          {message.clarification && onClarificationSelect && (\n            <ClarificationPrompt\n              question={message.clarification.question}\n              options={message.clarification.options}\n              onSelect={onClarificationSelect}\n            />\n          )}\n        </Box>\n      ))}\n      {isThinking && thinkingStartedAt && (\n        <ThinkingIndicator startedAt={thinkingStartedAt} />\n      )}\n    </Box>\n  );\n};\n\nexport default ChatThread;\n", "import { Box, Inline, Badge } from '@stripe/ui-extension-sdk/ui';\n\ninterface MessageBubbleProps {\n  role: 'user' | 'assistant';\n  content: string;\n  freshness?: { type: 'cached' | 'live'; syncedAt?: string };\n}\n\nconst MessageBubble = ({ role, content, freshness }: MessageBubbleProps) => {\n  const isUser = role === 'user';\n\n  return (\n    <Box\n      css={{\n        padding: 'medium',\n        backgroundColor: isUser ? 'container' : undefined,\n        stack: 'y',\n        gap: 'small',\n      }}\n    >\n      <Inline css={{ fontWeight: 'semibold', color: 'secondary' }}>\n        {isUser ? 'You' : 'Javelin'}\n      </Inline>\n      <Inline>{content}</Inline>\n      {freshness && !isUser && (\n        <Box css={{ marginTop: 'xsmall' }}>\n          <Badge type={freshness.type === 'live' ? 'positive' : 'info'}>\n            {freshness.type === 'live'\n              ? 'Live data'\n              : `Data as of ${freshness.syncedAt ? new Date(freshness.syncedAt).toLocaleString() : 'cache'}`}\n          </Badge>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default MessageBubble;\n", "import { Box, Banner, Button, Inline } from '@stripe/ui-extension-sdk/ui';\nimport { useState } from 'react';\nimport { apiClient } from '../lib/api-client';\n\ninterface InsightCardProps {\n  insightId: string;\n  messageId: string;\n  content: string;\n}\n\nconst InsightCard = ({ insightId, messageId, content }: InsightCardProps) => {\n  const [feedback, setFeedback] = useState<'positive' | 'negative' | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n\n  const handleFeedback = async (rating: 'positive' | 'negative') => {\n    if (submitting || feedback) return;\n    setSubmitting(true);\n    try {\n      await apiClient('/insights-feedback', {\n        method: 'POST',\n        body: { insightId, messageId, rating },\n      });\n      setFeedback(rating);\n    } catch {\n      // Silently fail \u2014 feedback is non-critical\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <Box css={{ padding: 'small', stack: 'y', gap: 'small' }}>\n      <Banner type=\"default\" title=\"Insight\" description={content} />\n      <Box css={{ stack: 'x', gap: 'small' }}>\n        <Button\n          type={feedback === 'positive' ? 'primary' : 'secondary'}\n          size=\"small\"\n          disabled={submitting || feedback !== null}\n          onPress={() => handleFeedback('positive')}\n        >\n          <Inline>{feedback === 'positive' ? 'Helpful' : 'Helpful?'}</Inline>\n        </Button>\n        <Button\n          type={feedback === 'negative' ? 'primary' : 'secondary'}\n          size=\"small\"\n          disabled={submitting || feedback !== null}\n          onPress={() => handleFeedback('negative')}\n        >\n          <Inline>{feedback === 'negative' ? 'Not helpful' : 'Not helpful?'}</Inline>\n        </Button>\n      </Box>\n    </Box>\n  );\n};\n\nexport default InsightCard;\n", "import fetchStripeSignature from '@stripe/ui-extension-sdk/signature';\n\n// Supabase Edge Functions base URL\nconst SUPABASE_FUNCTIONS_URL =\n  typeof process !== 'undefined' && process.env?.SUPABASE_FUNCTIONS_URL\n    ? process.env.SUPABASE_FUNCTIONS_URL\n    : 'https://tecvycpmzcxxoqmtttjy.supabase.co/functions/v1';\n\ninterface ApiResponse<T> {\n  data?: T;\n  error?: { code: string; message: string; requestId: string };\n  meta?: { freshness: 'cached' | 'live'; syncedAt?: string };\n}\n\ninterface SignatureContext {\n  userId: string;\n  accountId: string;\n}\n\nlet _signatureContext: SignatureContext | null = null;\n\n/**\n * Initialize the API client with the user's Stripe context.\n * Must be called once from a view that has ExtensionContextValue.\n */\nexport function initApiClient(userId: string, accountId: string) {\n  _signatureContext = { userId, accountId };\n}\n\nexport async function apiClient<T>(\n  path: string,\n  options: { method?: string; body?: unknown } = {},\n): Promise<ApiResponse<T>> {\n  if (!_signatureContext) {\n    throw new Error('apiClient not initialized \u2014 call initApiClient first');\n  }\n\n  // Try to get the Stripe signature; fallback gracefully for local dev\n  let signature = '';\n  try {\n    signature = await fetchStripeSignature();\n  } catch {\n    // fetchStripeSignature may not work in local preview mode\n    console.warn('fetchStripeSignature failed \u2014 sending unsigned request');\n  }\n\n  const method = options.method || 'POST';\n\n  // Always include user_id and account_id in the body for auth\n  const bodyPayload = {\n    user_id: _signatureContext.userId,\n    account_id: _signatureContext.accountId,\n    ...(options.body && typeof options.body === 'object' ? options.body : {}),\n  };\n\n  const response = await fetch(`${SUPABASE_FUNCTIONS_URL}${path}`, {\n    method,\n    headers: {\n      'Content-Type': 'application/json',\n      ...(signature ? { 'stripe-signature': signature } : {}),\n    },\n    body: JSON.stringify(bodyPayload),\n  });\n\n  if (!response.ok) {\n    const error = await response.json();\n    throw error;\n  }\n\n  return response.json();\n}\n", "import { Box, Spinner, Inline, Banner } from '@stripe/ui-extension-sdk/ui';\nimport { useState, useEffect } from 'react';\n\ninterface ThinkingIndicatorProps {\n  startedAt: number;\n}\n\nconst ThinkingIndicator = ({ startedAt }: ThinkingIndicatorProps) => {\n  const [elapsed, setElapsed] = useState(0);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setElapsed(Math.floor((Date.now() - startedAt) / 1000));\n    }, 1000);\n    return () => clearInterval(interval);\n  }, [startedAt]);\n\n  const statusText =\n    elapsed >= 5 ? 'Fetching fresh data from Stripe...' : 'Analyzing your data...';\n\n  return (\n    <Box css={{ padding: 'medium', stack: 'y', gap: 'small' }}>\n      <Box css={{ stack: 'x', gap: 'small', alignY: 'center' }}>\n        <Spinner size=\"small\" />\n        <Inline css={{ color: 'secondary' }}>{statusText}</Inline>\n      </Box>\n      {elapsed >= 5 && (\n        <Banner\n          type=\"default\"\n          description=\"Still working \u2014 fetching the latest data from Stripe to give you an accurate answer.\"\n        />\n      )}\n    </Box>\n  );\n};\n\nexport default ThinkingIndicator;\n", "import { Box, Banner, Button } from '@stripe/ui-extension-sdk/ui';\n\ninterface ClarificationOption {\n  label: string;\n  value: string;\n}\n\ninterface ClarificationPromptProps {\n  question: string;\n  options: ClarificationOption[];\n  onSelect: (value: string) => void;\n}\n\nconst ClarificationPrompt = ({ question, options, onSelect }: ClarificationPromptProps) => {\n  return (\n    <Box css={{ padding: 'medium', stack: 'y', gap: 'small' }}>\n      <Banner type=\"default\" title=\"Clarification needed\" description={question} />\n      <Box css={{ stack: 'x', gap: 'small', wrap: 'wrap' }}>\n        {options.map((option) => (\n          <Button\n            key={option.value}\n            type=\"secondary\"\n            size=\"small\"\n            onPress={() => onSelect(option.value)}\n          >\n            {option.label}\n          </Button>\n        ))}\n      </Box>\n    </Box>\n  );\n};\n\nexport default ClarificationPrompt;\n", "import { Box, TextArea, Button } from '@stripe/ui-extension-sdk/ui';\nimport { useState, useCallback } from 'react';\n\ninterface ChatInputProps {\n  onSend: (message: string) => void;\n  disabled?: boolean;\n  initialValue?: string;\n}\n\nconst ChatInput = ({ onSend, disabled = false, initialValue = '' }: ChatInputProps) => {\n  const [value, setValue] = useState(initialValue);\n\n  const handleSend = useCallback(() => {\n    const trimmed = value.trim();\n    if (!trimmed || disabled) return;\n    onSend(trimmed);\n    setValue('');\n  }, [value, disabled, onSend]);\n\n  return (\n    <Box css={{ stack: 'x', gap: 'small', alignY: 'bottom', padding: 'small' }}>\n      <Box css={{ width: 'fill' }}>\n        <TextArea\n          label=\"Ask a question\"\n          placeholder=\"What's my MRR?\"\n          value={value}\n          onChange={(e) => setValue(e.target.value)}\n          rows={2}\n          disabled={disabled}\n        />\n      </Box>\n      <Button\n        type=\"primary\"\n        onPress={handleSend}\n        disabled={disabled || !value.trim()}\n      >\n        Send\n      </Button>\n    </Box>\n  );\n};\n\nexport default ChatInput;\n", "import { Box, Inline, Button } from '@stripe/ui-extension-sdk/ui';\n\nconst GUIDED_PROMPTS = [\n  { label: \"What's my MRR?\", value: \"What's my MRR?\" },\n  { label: \"How's churn trending?\", value: \"How is my churn rate trending over the last 3 months?\" },\n  { label: 'Revenue by product', value: \"What's my revenue breakdown by product?\" },\n  { label: 'Top customers', value: 'Who are my top 10 customers by revenue?' },\n  { label: 'Growth rate', value: \"What's my MRR growth rate?\" },\n];\n\ninterface WelcomePromptProps {\n  onSelectPrompt: (prompt: string) => void;\n  insights?: Array<{ id: string; content: string }>;\n}\n\nconst WelcomePrompt = ({ onSelectPrompt, insights }: WelcomePromptProps) => {\n  return (\n    <Box css={{ padding: 'medium', stack: 'y', gap: 'medium' }}>\n      <Box css={{ stack: 'y', gap: 'small' }}>\n        <Inline css={{ font: 'heading' }}>Welcome to Javelin</Inline>\n        <Inline css={{ color: 'secondary' }}>\n          Ask me anything about your Stripe business. I can calculate metrics, analyze trends, and\n          surface insights from your data.\n        </Inline>\n      </Box>\n\n      {insights && insights.length > 0 && (\n        <Box css={{ stack: 'y', gap: 'small' }}>\n          <Inline css={{ fontWeight: 'semibold' }}>Recent insights</Inline>\n          {insights.map((insight) => (\n            <Box\n              key={insight.id}\n              css={{ padding: 'small', backgroundColor: 'container', stack: 'y', gap: 'xsmall' }}\n            >\n              <Inline css={{ color: 'secondary' }}>{insight.content}</Inline>\n            </Box>\n          ))}\n        </Box>\n      )}\n\n      <Box css={{ stack: 'y', gap: 'small' }}>\n        <Inline css={{ fontWeight: 'semibold' }}>Try asking</Inline>\n        <Box css={{ stack: 'x', gap: 'small', wrap: 'wrap' }}>\n          {GUIDED_PROMPTS.map((prompt) => (\n            <Button\n              key={prompt.value}\n              type=\"secondary\"\n              size=\"small\"\n              onPress={() => onSelectPrompt(prompt.value)}\n            >\n              {prompt.label}\n            </Button>\n          ))}\n        </Box>\n      </Box>\n\n      <Box css={{ marginTop: 'small' }}>\n        <Inline css={{ font: 'caption', color: 'secondary' }}>\n          Javelin provides informational insights only, not financial or business advice. Always verify important decisions with your own analysis.\n        </Inline>\n      </Box>\n    </Box>\n  );\n};\n\nexport default WelcomePrompt;\n", "import { Box, Inline, Button } from '@stripe/ui-extension-sdk/ui';\n\ninterface Conversation {\n  id: string;\n  title: string;\n  updatedAt: string;\n}\n\ninterface ConversationListProps {\n  conversations: Conversation[];\n  activeConversationId: string | null;\n  onSelectConversation: (id: string) => void;\n  onClose: () => void;\n}\n\nconst ConversationList = ({\n  conversations,\n  activeConversationId,\n  onSelectConversation,\n  onClose,\n}: ConversationListProps) => {\n  if (conversations.length === 0) {\n    return (\n      <Box css={{ padding: 'medium', stack: 'y', gap: 'small', alignX: 'center' }}>\n        <Inline css={{ color: 'secondary' }}>No conversations yet.</Inline>\n        <Inline css={{ color: 'secondary' }}>Start by asking a question below.</Inline>\n      </Box>\n    );\n  }\n\n  return (\n    <Box css={{ stack: 'y', gap: 'xsmall', padding: 'small' }}>\n      <Box css={{ stack: 'x', distribute: 'space-between', alignY: 'center', padding: 'xsmall' }}>\n        <Inline css={{ fontWeight: 'semibold' }}>Conversations</Inline>\n        <Button type=\"secondary\" size=\"small\" onPress={onClose}>\n          Close\n        </Button>\n      </Box>\n      {conversations.map((conv) => (\n        <Box\n          key={conv.id}\n          css={{\n            padding: 'small',\n            backgroundColor: conv.id === activeConversationId ? 'container' : undefined,\n            stack: 'y',\n            gap: 'xsmall',\n          }}\n        >\n          <Button\n            type=\"secondary\"\n            size=\"small\"\n            onPress={() => onSelectConversation(conv.id)}\n          >\n            <Box css={{ stack: 'y', gap: 'xsmall', width: 'fill' }}>\n              <Inline css={{ fontWeight: conv.id === activeConversationId ? 'semibold' : 'regular' }}>\n                {conv.title || 'Untitled conversation'}\n              </Inline>\n              <Inline css={{ font: 'caption', color: 'secondary' }}>\n                {new Date(conv.updatedAt).toLocaleDateString()}\n              </Inline>\n            </Box>\n          </Button>\n        </Box>\n      ))}\n    </Box>\n  );\n};\n\nexport default ConversationList;\n", "import { SettingsView, Box, Inline } from '@stripe/ui-extension-sdk/ui';\nimport type { ExtensionContextValue } from '@stripe/ui-extension-sdk/context';\n\nconst AppSettingsView = ({ userContext: _userContext }: ExtensionContextValue) => {\n  return (\n    <SettingsView>\n      <Box css={{ padding: 'medium' }}>\n        <Inline>Javelin settings coming soon.</Inline>\n      </Box>\n    </SettingsView>\n  );\n};\n\nexport default AppSettingsView;\n", "import {\n  ContextView,\n  Box,\n  Spinner,\n  Inline,\n  Banner,\n  Button,\n} from '@stripe/ui-extension-sdk/ui';\nimport type { ExtensionContextValue } from '@stripe/ui-extension-sdk/context';\nimport { useState, useEffect, useCallback } from 'react';\nimport { apiClient, initApiClient } from '../lib/api-client';\n\ntype OnboardingState = 'processing' | 'success' | 'error';\n\nconst OnboardingView = ({ userContext, oauthContext }: ExtensionContextValue) => {\n  // Initialize API client with Stripe context for signature verification\n  if (userContext?.id && userContext?.account?.id) {\n    initApiClient(userContext.id, userContext.account.id);\n  }\n  const [state, setState] = useState<OnboardingState>('processing');\n  const [errorMessage, setErrorMessage] = useState<string>('');\n\n  const handleOAuth = useCallback(async () => {\n    // Check for OAuth error\n    if (oauthContext?.error) {\n      setState('error');\n      setErrorMessage(`Authorization failed: ${oauthContext.error}`);\n      return;\n    }\n\n    // Check for OAuth code\n    if (!oauthContext?.code) {\n      setState('error');\n      setErrorMessage('No authorization code received. Please try installing again.');\n      return;\n    }\n\n    try {\n      // Exchange code for tokens via Edge Function\n      await apiClient('/auth-callback', {\n        method: 'POST',\n        body: {\n          code: oauthContext.code,\n          state: oauthContext.state || '',\n          verifier: oauthContext.verifier || '',\n        },\n      });\n\n      // Trigger initial data sync\n      await apiClient('/sync-trigger', {\n        method: 'POST',\n        body: {},\n      });\n\n      setState('success');\n    } catch {\n      setState('error');\n      setErrorMessage('Failed to complete setup. Please try again.');\n    }\n  }, [oauthContext]);\n\n  useEffect(() => {\n    handleOAuth();\n  }, [handleOAuth]);\n\n  return (\n    <ContextView title=\"Welcome to Javelin\">\n      <Box css={{ padding: 'medium', stack: 'y', gap: 'medium', alignX: 'center' }}>\n        {state === 'processing' && (\n          <>\n            <Spinner />\n            <Inline>Setting up Javelin...</Inline>\n            <Inline css={{ color: 'secondary' }}>\n              Connecting to your Stripe account and syncing your data.\n            </Inline>\n          </>\n        )}\n\n        {state === 'success' && (\n          <>\n            <Banner\n              type=\"default\"\n              title=\"Setup complete!\"\n              description=\"Javelin is ready. Your data is syncing in the background \u2014 you can start asking questions right away.\"\n            />\n            <Inline css={{ color: 'secondary' }}>\n              Open the Javelin drawer from any page in your Stripe Dashboard to get started.\n            </Inline>\n          </>\n        )}\n\n        {state === 'error' && (\n          <>\n            <Banner type=\"critical\" title=\"Setup failed\" description={errorMessage} />\n            <Button type=\"primary\" onPress={handleOAuth}>\n              Retry\n            </Button>\n          </>\n        )}\n      </Box>\n    </ContextView>\n  );\n};\n\nexport default OnboardingView;\n"],
  "mappings": "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",
  "names": ["require_version", "__commonJSMin", "exports", "require_ui", "__commonJSMin", "exports", "jsx_runtime_1", "react_1", "version_1", "withSdkProps", "Component", "wrappedComponentName", "WithSdkProps", "props", "__spreadProps", "__spreadValues", "defineComponent", "name", "fragmentProps", "wrapWithSdkProps", "remoteComponent", "require_browser", "__commonJSMin", "exports", "module", "invariant", "condition", "format", "a", "b", "c", "e", "f", "error", "args", "argIndex", "require_endpoint", "__commonJSMin", "exports", "__importDefault", "mod", "invariant_1", "getHostEndpoint", "_a", "hostEndpoint", "require_supportsFetchAppEmbeddedKey", "__commonJSMin", "exports", "_endpoint_1", "supportsFetchAppEmbeddedKey", "__async", "supported", "require_fetchAppEmbeddedKey", "__commonJSMin", "exports", "_endpoint_1", "fetchAppEmbeddedKey", "__async", "apiKey", "require_fetchViaFrame", "__commonJSMin", "exports", "fetchAppEmbeddedKey_1", "fetchViaFrame", "_0", "_1", "__async", "url", "options", "apiKey", "init", "__spreadProps", "__spreadValues", "response", "headers", "value", "key", "serializableResponse", "require_fetchViaHost", "__commonJSMin", "exports", "_endpoint_1", "fetchViaHost", "_0", "_1", "__async", "encodedUrl", "options", "url", "require_selectPreferredStripeApiFetch", "__commonJSMin", "exports", "supportsFetchAppEmbeddedKey_1", "fetchViaFrame_1", "fetchViaHost_1", "selectedStripeApiFetch", "selectPreferredStripeApiFetch", "__async", "require_api", "__commonJSMin", "exports", "selectPreferredStripeApiFetch_1", "require_apiFetch", "__commonJSMin", "exports", "api_1", "stripeApiFetch", "path", "options", "__async", "require_httpClient", "__commonJSMin", "exports", "__importDefault", "mod", "invariant_1", "apiFetch_1", "matchesStripeKey", "StripeAppsHttpResponse", "resp", "json", "StripeAppsHttpClient", "fetch", "host", "port", "path", "method", "headers", "requestData", "protocol", "_timeout", "__async", "fetchOptions", "authHeader", "url", "createHttpClient", "require_createFetchStripeSignatureDirectly", "__commonJSMin", "exports", "httpClient_1", "createFetchStripeSignatureDirectly", "host", "port", "payload", "__async", "url", "__spreadValues", "r", "data", "require_connectionSettings", "__commonJSMin", "exports", "defaultConnectionSettings", "setConnectionSettings", "settings", "__spreadValues", "require_signature", "__commonJSMin", "exports", "createFetchStripeSignatureDirectly_1", "supportsFetchAppEmbeddedKey_1", "connectionSettings_1", "_endpoint_1", "fetchStripeSignature", "additionalPayload", "__async", "require_signature", "__commonJSMin", "exports", "signature_1", "manifest_exports", "__export", "BUILD_TIME", "ChatView_default", "OnboardingView_default", "SettingsView_default", "manifest_default", "import_ui", "import_react", "import_ui", "import_ui", "import_jsx_runtime", "MessageBubble", "role", "content", "freshness", "isUser", "MessageBubble_default", "import_ui", "import_react", "import_signature", "_a", "SUPABASE_FUNCTIONS_URL", "_signatureContext", "initApiClient", "userId", "accountId", "apiClient", "_0", "__async", "path", "options", "signature", "fetchStripeSignature", "e", "method", "bodyPayload", "__spreadValues", "response", "import_jsx_runtime", "InsightCard", "insightId", "messageId", "content", "feedback", "setFeedback", "submitting", "setSubmitting", "handleFeedback", "rating", "__async", "apiClient", "e", "InsightCard_default", "import_ui", "import_react", "import_jsx_runtime", "ThinkingIndicator", "startedAt", "elapsed", "setElapsed", "interval", "statusText", "ThinkingIndicator_default", "import_ui", "import_jsx_runtime", "ClarificationPrompt", "question", "options", "onSelect", "option", "ClarificationPrompt_default", "import_jsx_runtime", "ChatThread", "messages", "isThinking", "thinkingStartedAt", "onClarificationSelect", "message", "_a", "MessageBubble_default", "insight", "InsightCard_default", "ClarificationPrompt_default", "ThinkingIndicator_default", "ChatThread_default", "import_ui", "import_react", "import_jsx_runtime", "ChatInput", "onSend", "disabled", "initialValue", "value", "setValue", "handleSend", "trimmed", "e", "ChatInput_default", "import_ui", "import_jsx_runtime", "GUIDED_PROMPTS", "WelcomePrompt", "onSelectPrompt", "insights", "insight", "prompt", "WelcomePrompt_default", "import_ui", "import_jsx_runtime", "ConversationList", "conversations", "activeConversationId", "onSelectConversation", "onClose", "conv", "ConversationList_default", "import_jsx_runtime", "ChatView", "userContext", "_environment", "_a", "initApiClient", "viewState", "setViewState", "conversations", "setConversations", "activeConversationId", "setActiveConversationId", "messages", "setMessages", "isThinking", "setIsThinking", "thinkingStartedAt", "setThinkingStartedAt", "error", "setError", "welcomeInsights", "setWelcomeInsights", "showConversationList", "setShowConversationList", "loadConversations", "__async", "convos", "apiClient", "loadWelcomeInsights", "loadConversation", "e", "response", "conversationId", "msgs", "m", "_b", "sendMessage", "content", "_c", "_d", "_e", "userMessage", "prev", "assistantMessage", "err", "errorObj", "code", "handleClarificationSelect", "value", "handleNewConversation", "handleSelectConversation", "id", "v", "ConversationList_default", "WelcomePrompt_default", "ChatThread_default", "ChatInput_default", "ChatView_default", "import_ui", "import_jsx_runtime", "AppSettingsView", "_userContext", "SettingsView_default", "import_ui", "import_react", "import_jsx_runtime", "OnboardingView", "userContext", "oauthContext", "_a", "initApiClient", "state", "setState", "errorMessage", "setErrorMessage", "handleOAuth", "__async", "apiClient", "e", "OnboardingView_default", "__reExport", "manifest_exports", "BUILD_TIME", "manifest_default"]
}
